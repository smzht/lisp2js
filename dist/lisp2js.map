{"version":3,"file":"lisp2js.js","sources":["webpack:///lisp2js.js"],"sourcesContent":["!function(r){var e={};function n(t){if(e[t])return e[t].exports;var i=e[t]={i:t,l:!1,exports:{}};return r[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=r,n.c=e,n.d=function(r,e,t){n.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:t})},n.r=function(r){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(r,\"__esModule\",{value:!0})},n.t=function(r,e){if(1&e&&(r=n(r)),8&e)return r;if(4&e&&\"object\"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:r}),2&e&&\"string\"!=typeof r)for(var i in r)n.d(t,i,function(e){return r[e]}.bind(null,i));return t},n.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return n.d(e,\"a\",e),e},n.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},n.p=\"\",n(n.s=0)}([function(r,e,n){\"use strict\";for(var t=n(1).LISP,i=[n(4),n(5),n(6),n(7),n(8)],u=0;u<i.length;u++){(0,i[u])(t)}r.exports={LISP:t},\"undefined\"!=typeof window&&(window.LISP=t)},function(module,exports,__webpack_require__){\"use strict\";(function(process,global){var _typeof=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&\"function\"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?\"symbol\":typeof r},_createClass=function(){function r(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,\"value\"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}();function _possibleConstructorReturn(r,e){if(!r)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!e||\"object\"!=typeof e&&\"function\"!=typeof e?r:e}function _inherits(r,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}function _classCallCheck(r,e){if(!(r instanceof e))throw new TypeError(\"Cannot call a class as a function\")}var SObject=function r(){_classCallCheck(this,r)},_Symbol=function(r){function e(r){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.name=r,n}return _inherits(e,SObject),_createClass(e,[{key:\"toString\",value:function(){return this.name}}],[{key:\"getTypeName\",value:function(){return\"symbol\"}}]),e}(),Keyword=function(r){function e(r){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.name=r,n}return _inherits(e,SObject),_createClass(e,[{key:\"toString\",value:function(r){return r?\":\"+this.name:this.name}}],[{key:\"getTypeName\",value:function(){return\"keyword\"}}]),e}(),Cons=function(r){function e(r,n,t,i){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return u.car=r,u.cdr=n,null!=t&&(u.lineNo=t,u.path=i),u}return _inherits(e,SObject),_createClass(e,[{key:\"toString\",value:function(r){var n=e.canAbbrev(this);if(n)return\"\"+n+makeString(this.cdr.car,r);var t=[],i=\"(\",u=void 0;for(u=this;u instanceof e;u=u.cdr)t.push(i),t.push(makeString(u.car,r)),i=\" \";return u!==LISP.nil&&(t.push(\" . \"),t.push(makeString(u,r))),t.push(\")\"),t.join(\"\")}},{key:\"toArray\",value:function(){for(var r=[],n=this;n instanceof e;n=n.cdr)r.push(n.car);return r}}],[{key:\"getTypeName\",value:function(){return\"pair\"}},{key:\"canAbbrev\",value:function(r){var n={quote:\"'\",quasiquote:\"`\",unquote:\",\",\"unquote-splicing\":\",@\"};return!!(r.car instanceof _Symbol&&r.car.name in n&&r.cdr instanceof e&&LISP[\"eq?\"](r.cdr.cdr,LISP.nil))&&n[r.car.name]}}]),e}(),HashTable=function(r){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,SObject),_createClass(e,[{key:\"toString\",value:function(){var r=\"\";for(var e in this)this.hasOwnProperty(e)&&(r.length>0&&(r+=\", \"),r+=e+\":\"+this[e]);return\"#table<\"+r+\">\"}}],[{key:\"getTypeName\",value:function(){return\"table\"}}]),e}(),Stream=function(r){function e(){_classCallCheck(this,e);var r=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.str=\"\",r.lineNo=0,r}return _inherits(e,SObject),_createClass(e,[{key:\"close\",value:function(){}},{key:\"peek\",value:function(){var r=this.fetch();return null==r?r:this.str[0]}},{key:\"getc\",value:function(){var r=this.peek();return null==r?r:(this.str=this.str.slice(1),r)}},{key:\"ungetc\",value:function(r){this.str?this.str=r+this.str:this.str=r}},{key:\"match\",value:function(r,e){var n=this.fetch();if(null==n)return n;var t=this.str.match(r);return t&&!e&&(this.str=RegExp.rightContext),t}},{key:\"eof\",value:function(){return null==this.str}},{key:\"getLine\",value:function(){var r=this.str||this.readLine();return this.str=\"\",r}},{key:\"fetch\",value:function(){if(null==this.str)return null;for(;\"\"===this.str;){if(null==(this.str=this.readLine()))return;++this.lineNo}return this.str}}]),e}(),StrStream=function(r){function e(r){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.str=r,n.lineNo=1,n}return _inherits(e,Stream),_createClass(e,[{key:\"readLine\",value:function(){return null}}]),e}(),inspectString=function(r){var e={\"\\\\\":\"\\\\\\\\\",\"\\t\":\"\\\\t\",\"\\n\":\"\\\\n\",'\"':'\\\\\"'};return'\"'+r.replace(/[\\x00-\\x1f\\\"\\\\]/g,function(r){return r in e?e[r]:\"\\\\x\"+(\"0\"+r.charCodeAt(0).toString(16)).slice(-2)})+'\"'},makeString=function r(e,n){if(e===LISP.nil)return\"nil\";if(e===LISP.t)return\"t\";switch(void 0===e?\"undefined\":_typeof(e)){case\"string\":return n?inspectString(e):e;case\"function\":return e.name?\"#<function \"+e.name+\">\":\"#<function>\";default:return e instanceof Array?\"#(\"+e.map(function(e){return r(e,n)}).join(\" \")+\")\":null==e?\"\"+e:e.toString(n)}},LISP=function(createLisp,installEval){var LISP=function(r){var e={},n=function(r){return r?e.t:e.nil};e.nil=!1,e.t=!0,e.isTrue=function(r){return r!==e.nil&&null!=r},e._getRestArgs=function(r,n){return function(r){for(var n=e.nil,t=r.length;--t>=0;)n=e.cons(r[t],n);return n}(Array.prototype.slice.call(r,n))},e._output=void 0!==process?function(r){process.stdout.write(r)}:function(r){console.log(r)};var t={};e[\"register-macro\"]=function(r,e){return t[r]=e,r},e[\"macroexpand-1\"]=function(r){if(!(e[\"pair?\"](r)&&r.car in t))return r;var n=t[r.car];return e.apply(n,r.cdr)},e.error=function(){throw new Error(Array.prototype.slice.call(arguments).join(\", \"))},e.new=function(r){return new(Function.prototype.bind.apply(r,arguments))},e[\"symbol->string\"]=function(r){return r.name};var i={};e.intern=function(r){return r in i?i[r]:i[r]=new _Symbol(r)};var u=0;e.gensym=function(){return e.intern(\"__\"+ ++u)};var o={};e[\"make-keyword\"]=function(r){return r in o?o[r]:o[r]=new Keyword(r)},e[\"keyword->string\"]=function(r){return r.name},e.type=function(r){var n=void 0;return r===e.nil||r===e.t?n=\"bool\":\"object\"===(n=void 0===r?\"undefined\":_typeof(r))&&(r instanceof Array&&(n=\"vector\"),r instanceof RegExp?n=\"regexp\":r instanceof SObject&&(n=r.constructor.getTypeName())),e.intern(n)},e[\"eq?\"]=function(r,e){return n(r===e)},e.cons=function(r,e){return new Cons(r,e)},e.car=function(r){return r instanceof Cons?r.car:r},e.cdr=function(r){return r instanceof Cons?r.cdr:e.nil},e[\"set-car!\"]=function(r,e){return r.car=e},e[\"set-cdr!\"]=function(r,e){return r.cdr=e},e.list=function(){for(var r=e.nil,n=arguments.length;--n>=0;)r=e.cons(arguments[n],r);return r},e[\"reverse!\"]=function(r){for(var n=e.nil,t=r;e[\"pair?\"](t);){var i=t.cdr;t.cdr=n,n=t,t=i}return n},e[\"number->string\"]=function(r,e){return r.toString(e)},e[\"+\"]=function(){if(0===arguments.length)return 0;for(var r=arguments[0],e=1;e<arguments.length;++e)r+=arguments[e];return r},e[\"*\"]=function(){if(0===arguments.length)return 1;for(var r=arguments[0],e=1;e<arguments.length;++e)r*=arguments[e];return r},e[\"-\"]=function(){if(0===arguments.length)return 0;var r=arguments[0];if(1===arguments.length)return-r;for(var e=1;e<arguments.length;++e)r-=arguments[e];return r},e[\"/\"]=function(){if(0===arguments.length)return 1;var r=arguments[0];if(1===arguments.length)return 1/r;for(var e=1;e<arguments.length;++e)r/=arguments[e];return r},e[\"%\"]=function(){if(0===arguments.length)return 0;var r=arguments[0];if(1===arguments.length)return r;for(var e=1;e<arguments.length;++e)r%=arguments[e];return r},e[\"<\"]=function(){if(arguments.length>0)for(var r=arguments[0],n=1;n<arguments.length;++n){var t=arguments[n];if(!(r<t))return e.nil;r=t}return e.t},e[\">\"]=function(){if(arguments.length>0)for(var r=arguments[0],n=1;n<arguments.length;++n){var t=arguments[n];if(!(r>t))return e.nil;r=t}return e.t},e[\"<=\"]=function(){if(arguments.length>0)for(var r=arguments[0],n=1;n<arguments.length;++n){var t=arguments[n];if(!(r<=t))return e.nil;r=t}return e.t},e[\">=\"]=function(){if(arguments.length>0)for(var r=arguments[0],n=1;n<arguments.length;++n){var t=arguments[n];if(!(r>=t))return e.nil;r=t}return e.t},e[\"string=?\"]=function(r,e){return n(r===e)},e[\"string-append\"]=function(){return Array.prototype.slice.call(arguments).join(\"\")},e[\"string-join\"]=function(r,n){return r===e.nil?\"\":r.toArray().join(n)},e[\"string-length\"]=function(r){return r.length},e[\"string-ref\"]=function(r,e){return r[e]},e.substring=function(r,e,n){return r.slice(e,n)},e[\"string-scan\"]=function(r,n){var t=r.indexOf(n);return t>=0?t:e.nil},e[\"string->number\"]=function(r,e){return e?parseInt(r,e):parseFloat(r)},e[\"char->number\"]=function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return r.charCodeAt(e)},e[\"number->char\"]=function(r){return String.fromCharCode(r)},e[\"x->string\"]=makeString,e.print=function(r,n){var t=makeString(r);return n?n.write(t):e._output(t),r},e.puts=function(r){return e._output(makeString(r)),void 0!==process&&e._output(\"\\n\"),r},e.write=function(r){return e._output(makeString(r,10)),r},e.apply=function(r){for(var n=arguments.length,t=Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];if(t.length>0){var u=t.pop();u!==e.nil&&(t=t.concat(u.toArray()))}return r.apply(null,t)},e.JS=r,e[\"make-hash-table\"]=function(){return new HashTable},e[\"hash-table-exists?\"]=function(r,n){return n in r?e.t:e.nil},e[\"hash-table-get\"]=function(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.nil;return n in r?r[n]:t},e[\"hash-table-put!\"]=function(r,e,n){return r[e]=n},e.vector=function(){return Array.prototype.slice.call(arguments)},e[\"make-vector\"]=function(r,n){void 0===n&&(n=e.nil);for(var t=new Array(r),i=0;i<r;++i)t[i]=n;return t},e[\"vector-length\"]=function(r){return r.length},e[\"vector-ref\"]=function(r,e){return r[e]},e[\"vector-set!\"]=function(r,e,n){return r[e]=n},e.regexp=function(r){return new RegExp(r)},e.rxmatch=function(r,e){return n(r.exec(e))},e[\"regexp-replace-all\"]=function(r,e,n){if(!r.global){var t=r.toString(),i=t.lastIndexOf(\"/\");r=new RegExp(t.slice(1,i),t.slice(i+1)+\"g\")}return e.replace(r,function(r){return n(function(){return r})})},e[\"regexp->string\"]=function(r){var e=r.toString();return e.slice(1,e.length-1)},e[\"make-string-input-stream\"]=function(r,e,n){return void 0===e&&void 0===n||(r=r.slice(0|e,n|r.length)),new StrStream(r)},e.NoCloseParenException=function(){},e.NoCloseQuoteException=function(){},e.UnexpectedCharacterException=function(r){this.char=r};var c=new RegExp(\"^\\\\.(?=([\\\\s(){}\\\\[\\\\]'`,;#\\\"]|$))\"),s=new RegExp(\"^([^.\\\\s(){}\\\\[\\\\]'`,;#\\\"][^\\\\s(){}\\\\[\\\\]'`,;#\\\"]*)\"),a={dispatchTable:{}},l=function(r,e){var n=a.dispatchTable[e],t=r.peek();if(t in n)return n[t](r,e,r.getc());throw new Error(\"No dispatch macro character: \"+e+t)},f=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:\"skipWhitespaces\",value:function(r){do{if(r.eof())return!1}while(r.match(/^(\\s+|$)/));return!0}},{key:\"read\",value:function(n){if(!r.skipWhitespaces(n))return null;var t=n.peek();if(null==t)return null;if(t in a)return a[t](n,n.getc());var i=void 0;if(!n.match(c,!0)){if(i=n.match(s))return r.readSymbolOrNumber(i[1]);throw new e.UnexpectedCharacterException(n.peek())}}},{key:\"readSymbolOrNumber\",value:function(r){return\"nil\"===r?e.nil:\"t\"===r?e.t:\":\"===r[0]?e[\"make-keyword\"](r.slice(1)):r.match(/^([+\\-]?[0-9]+(\\.[0-9]*)?)$/)?parseFloat(r):e.intern(r)}},{key:\"readList\",value:function(n){for(var t=e.nil;;){r.skipWhitespaces(n);var i=n.peek();if(\")\"===i)return n.getc(),e[\"reverse!\"](t);if(n.match(c)){var u=r.read(n);if(null!=u&&n.match(/^\\s*\\)/)){var o=e[\"reverse!\"](t);return t.cdr=u,o}break}var s=r.read(n);if(null==s)break;t=new Cons(s,t,n.lineNo,n.path)}throw new e.NoCloseParenException}},{key:\"setMacroCharacter\",value:function(r,e){a[r]=e}},{key:\"setDispatchMacroCharacter\",value:function(r,e,n){r in a.dispatchTable||(a.dispatchTable[r]={}),a.dispatchTable[r][e]=n,a[r]=l}}]),r}();return e[\"set-macro-character\"]=f.setMacroCharacter,e[\"set-dispatch-macro-character\"]=f.setDispatchMacroCharacter,f.setMacroCharacter(\"(\",function(r,e){return f.readList(r)}),e.read=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e[\"*stdin*\"],n=arguments[1],t=arguments[2],i=f.read(r);if(null!=i)return i;if(e.isTrue(n))throw new Error(\"EOF\");return null!=t?t:e.nil},e[\"read-from-string\"]=function(r){return f.read(new StrStream(r))},e[\"read-line\"]=function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e[\"*stdin*\"]).getLine();return null==r?e.nil:(r.length>0&&\"\\n\"===r[r.length-1]&&(r=r.slice(0,r.length-1)),r)},e[\"read-char\"]=function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e[\"*stdin*\"]).getc();return null!=r?r:e.nil},e[\"unread-char\"]=function(r){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e[\"*stdin*\"]).ungetc(r),e.nil},e}(\"undefined\"!=typeof window?window:void 0!==global?global:{});return function(LISP){LISP.eval=function _eval(exp){return eval(LISP.compile(exp))}}(LISP),LISP}();module.exports={LISP:LISP,Stream:Stream}}).call(this,__webpack_require__(2),__webpack_require__(3))},function(r,e){var n,t,i=r.exports={};function u(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function c(r){if(n===setTimeout)return setTimeout(r,0);if((n===u||!n)&&setTimeout)return n=setTimeout,setTimeout(r,0);try{return n(r,0)}catch(e){try{return n.call(null,r,0)}catch(e){return n.call(this,r,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:u}catch(r){n=u}try{t=\"function\"==typeof clearTimeout?clearTimeout:o}catch(r){t=o}}();var s,a=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?a=s.concat(a):f=-1,a.length&&d())}function d(){if(!l){var r=c(p);l=!0;for(var e=a.length;e;){for(s=a,a=[];++f<e;)s&&s[f].run();f=-1,e=a.length}s=null,l=!1,function(r){if(t===clearTimeout)return clearTimeout(r);if((t===o||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(r);try{t(r)}catch(e){try{return t.call(null,r)}catch(e){return t.call(this,r)}}}(r)}}function m(r,e){this.fun=r,this.array=e}function g(){}i.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new m(r,e)),1!==a.length||l||c(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(r){return[]},i.binding=function(r){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(r){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},function(r,e){var n;n=function(){return this}();try{n=n||Function(\"return this\")()||(0,eval)(\"this\")}catch(r){\"object\"==typeof window&&(n=window)}r.exports=n},function(r,e,n){\"use strict\";r.exports=function(r){r[\"register-macro\"](r.intern(\"defmacro\"),function(e,n){var t=r._getRestArgs(arguments,2);return r.list(r.intern(\"register-macro\"),r.list(r.intern(\"quote\"),e),r[\"list*\"](r.intern(\"lambda\"),n,t))}),r.macroexpand=function(e){return function(n){return r.isTrue(r[\"equal?\"](n,e))?e:r.macroexpand(n)}(r[\"macroexpand-1\"](e))},r[\"set-macro-character\"](\";\",function(e,n){return function(n){return(n=function(){return function(t){return r.isTrue(r[\"null?\"](t))?t:r.isTrue(r[\"eq?\"](t,\"\\n\"))?r.read(e):n()}(r[\"read-char\"](e))})()}(r.nil)}),r[\"set-macro-character\"](\"'\",function(e,n){return r.list(r.intern(\"quote\"),r.read(e))}),r[\"set-macro-character\"](\"`\",function(e,n){return r.list(r.intern(\"quasiquote\"),r.read(e))}),r[\"set-macro-character\"](\",\",function(e,n){return function(n){return r.isTrue(r[\"eq?\"](n,\"@\"))?r.list(r.intern(\"unquote-splicing\"),r.read(e)):(r[\"unread-char\"](n,e),r.list(r.intern(\"unquote\"),r.read(e)))}(r[\"read-char\"](e))}),r[\"set-macro-character\"]('\"',function(e,n){return function(n){return(n=function(t){return function(i){return r.isTrue(r[\"null?\"](i))?r.error(\"NoCloseQuoteException\"):r.isTrue(r[\"eq?\"](i,'\"'))?r[\"string-join\"](r[\"reverse!\"](t),\"\"):r.isTrue(r[\"eq?\"](i,\"\\\\\"))?n(r.cons(function(n){return function(t){return r.isTrue(r[\"eq?\"](t,\"x\"))?function(n){return function(e){return r[\"number->char\"](r[\"string->number\"](r[\"string-append\"](n,e),16))}(r[\"read-char\"](e))}(r[\"read-char\"](e)):r.isTrue(r[\"eq?\"](t,\"t\"))?\"\\t\":r.isTrue(r[\"eq?\"](t,\"n\"))?\"\\n\":n}(n)}(r[\"read-char\"](e)),t)):n(r.cons(i,t))}(r[\"read-char\"](e))})(r.nil)}(r.nil)}),r[\"set-dispatch-macro-character\"](\"#\",\"|\",function(e,n,t){return function(n){return(n=function(t){return function(i){return r.isTrue(r[\"null?\"](i))?r.error(\"Block comment not closed\"):r.isTrue(r[\"eq?\"](t,\"|\"))&&r.isTrue(r[\"eq?\"](i,\"#\"))?r.read(e):n(i)}(r[\"read-char\"](e))})(r.nil)}(r.nil)}),r[\"set-dispatch-macro-character\"](\"#\",\"(\",function(e,n,t){return r[\"unread-char\"](\"(\",e),function(e){return r.apply(r.vector,e)}(r.read(e))}),r[\"set-dispatch-macro-character\"](\"#\",\"/\",function(e,n,t){return function(n){return(n=function(t){return function(e){return r.isTrue(r[\"eq?\"](e,\"/\"))?r.regexp(r[\"string-join\"](r[\"reverse!\"](t),\"\")):r.isTrue(r[\"null?\"](e))||r.isTrue(r[\"eq?\"](e,\"\\n\"))?r.error(\"Regexp not terminated\"):n(r.cons(e,t))}(r[\"read-char\"](e))})(r.nil)}(r.nil)}),r[\"set-dispatch-macro-character\"](\"#\",\".\",function(e,n,t){return r.eval(r.read(e))}),r[\"register-macro\"](r.intern(\"defun\"),function(e,n){var t=r._getRestArgs(arguments,2);return r.list(r.intern(\"def\"),e,r[\"list*\"](r.intern(\"lambda\"),n,t))}),r[\"register-macro\"](r.intern(\"let\"),function(e){var n=r._getRestArgs(arguments,1);return r.isTrue(r[\"symbol?\"](e))?function(){var e=r.list(r.nil);return function(n,t,i){return r[\"list*\"](r.list(r.intern(\"lambda\"),r.list(n),r.list(r.intern(\"set!\"),n,r[\"list*\"](r.intern(\"lambda\"),r.map(r.car,t),i)),r[\"list*\"](n,r.map(r.cadr,t))),e)}}()(e,r.car(n),r.cdr(n)):r[\"list*\"](r[\"list*\"](r.intern(\"lambda\"),r.map(r.car,e),n),r.map(r.cadr,e))}),r[\"register-macro\"](r.intern(\"let1\"),function(e,n){var t=r._getRestArgs(arguments,2);return r[\"list*\"](r.intern(\"let\"),r.list(r.list(e,n)),t)}),r[\"register-macro\"](r.intern(\"let*\"),function(e){var n=r._getRestArgs(arguments,1);return r.isTrue(r[\"null?\"](e))?r[\"list*\"](r.intern(\"progn\"),n):r.list(r.intern(\"let1\"),r.caar(e),r.cadar(e),r[\"list*\"](r.intern(\"let*\"),r.cdr(e),n))}),r[\"register-macro\"](r.intern(\"when\"),function(e){var n=r._getRestArgs(arguments,1);return r.list(r.intern(\"if\"),e,r[\"list*\"](r.intern(\"progn\"),n))}),r[\"register-macro\"](r.intern(\"unless\"),function(e){var n=r._getRestArgs(arguments,1);return r.list(r.intern(\"if\"),e,r.nil,r[\"list*\"](r.intern(\"progn\"),n))}),r[\"register-macro\"](r.intern(\"cond\"),function(){var e=r._getRestArgs(arguments,0);return r.isTrue(r[\"null?\"](e))?r.nil:function(e,n){return r.isTrue(r[\"eq?\"](r.car(e),r.t))?r[\"list*\"](r.intern(\"progn\"),r.cdr(e)):r.isTrue(r[\"null?\"](r.cdr(e)))?function(t){return r.list(r.intern(\"let\"),r.list(r.list(t,r.car(e))),r.list(r.intern(\"if\"),t,t,r[\"list*\"](r.intern(\"cond\"),n)))}(r.gensym()):r.isTrue(r[\"eq?\"](r.cadr(e),r.intern(\"=>\")))?function(t){return r.list(r.intern(\"let\"),r.list(r.list(t,r.car(e))),r.list(r.intern(\"if\"),t,r.list(r.caddr(e),t),r[\"list*\"](r.intern(\"cond\"),n)))}(r.gensym()):r.list(r.intern(\"if\"),r.car(e),r[\"list*\"](r.intern(\"progn\"),r.cdr(e)),r[\"list*\"](r.intern(\"cond\"),n))}(r.car(e),r.cdr(e))}),r[\"register-macro\"](r.intern(\"case\"),function(e){var n=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern(\"let1\"),t,e,r[\"list*\"](r.intern(\"cond\"),r.map(function(e){return r.isTrue(r[\"eq?\"](r.car(e),r.t))?e:r.isTrue(r[\"null?\"](r.cdar(e)))?r[\"list*\"](r.list(r.intern(\"eq?\"),t,r.list(r.intern(\"quote\"),r.caar(e))),r.cdr(e)):r[\"list*\"](r.list(r.intern(\"member\"),t,r.list(r.intern(\"quote\"),r.car(e))),r.cdr(e))},n)))}(r.gensym())}),r[\"register-macro\"](r.intern(\"and\"),function(){var e=r.list(r.nil);return function(){var n=r._getRestArgs(arguments,0);return r.isTrue(r[\"null?\"](n))?r.t:r.isTrue(r[\"null?\"](r.cdr(n)))?r.car(n):r[\"list*\"](r.intern(\"if\"),r.car(n),r[\"list*\"](r.intern(\"and\"),r.cdr(n)),e)}}()),r[\"register-macro\"](r.intern(\"or\"),function(){var e=r._getRestArgs(arguments,0);return r.isTrue(r[\"null?\"](r.cdr(e)))?r.car(e):function(n){return r.list(r.intern(\"let1\"),n,r.car(e),r.list(r.intern(\"if\"),n,n,r[\"list*\"](r.intern(\"or\"),r.cdr(e))))}(r.gensym())}),r[\"register-macro\"](r.intern(\"progn\"),function(){var e=r._getRestArgs(arguments,0);return r.isTrue(r[\"null?\"](e))?r.nil:r.isTrue(r[\"null?\"](r.cdr(e)))?r.car(e):r[\"list*\"](r.intern(\"let\"),r.nil,e)}),r[\"register-macro\"](r.intern(\"aif\"),function(e,n){var t=r._getRestArgs(arguments,2);return r.list(r.intern(\"let1\"),r.intern(\"it\"),e,r[\"list*\"](r.intern(\"if\"),r.intern(\"it\"),n,t))}),r[\"register-macro\"](r.intern(\"awhen\"),function(e){var n=r._getRestArgs(arguments,1);return r.list(r.intern(\"aif\"),e,r[\"list*\"](r.intern(\"progn\"),n))}),r[\"register-macro\"](r.intern(\"awhile\"),function(e){var n=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern(\"let\"),t,r.nil,r.list(r.intern(\"let1\"),r.intern(\"it\"),e,r[\"list*\"](r.intern(\"when\"),r.intern(\"it\"),r.append(n,r.list(r.list(t))))))}(r.gensym())}),r[\"null?\"]=function(e){return r[\"eq?\"](e,r.nil)},r.not=function(e){return r[\"eq?\"](e,r.nil)},r.caar=function(e){return r.car(r.car(e))},r.cadr=function(e){return r.car(r.cdr(e))},r.cdar=function(e){return r.cdr(r.car(e))},r.cddr=function(e){return r.cdr(r.cdr(e))},r.cadar=function(e){return r.cadr(r.car(e))},r.caddr=function(e){return r.car(r.cddr(e))},r.cdddr=function(e){return r.cdr(r.cddr(e))},r[\"equal?\"]=function(e,n){return r.isTrue(r[\"eq?\"](e,n))?r.t:function(t){return r.isTrue(r[\"eq?\"](t,r.type(n)))?function(t){return r.isTrue(r[\"eq?\"](t,r.intern(\"pair\")))?r.isTrue(r[\"equal?\"](r.car(e),r.car(n)))?r[\"equal?\"](r.cdr(e),r.cdr(n)):r.nil:r.isTrue(r[\"eq?\"](t,r.intern(\"vector\")))?function(t){return r.isTrue(r[\"eq?\"](t,r[\"vector-length\"](n)))?function(i){return(i=function(u){return function(t){return r.isTrue(t)?t:r.isTrue(r[\"equal?\"](r[\"vector-ref\"](e,u),r[\"vector-ref\"](n,u)))?i(u+1):r.nil}(r[\">=\"](u,t))})(0)}(r.nil):r.nil}(r[\"vector-length\"](e)):r.nil}(t):r.nil}(r.type(e))},r.length=function(e){return function(n){return(n=function(e,t){return r.isTrue(r[\"pair?\"](e))?n(r.cdr(e),t+1):t})(e,0)}(r.nil)},r.member=function(e,n){return r.isTrue(r[\"null?\"](n))?r.nil:r.isTrue(r[\"eq?\"](e,r.car(n)))?n:r.member(e,r.cdr(n))},r.assoc=function(e,n){return r.isTrue(r[\"null?\"](n))?r.nil:r.isTrue(r[\"eq?\"](e,r.caar(n)))?r.car(n):r.assoc(e,r.cdr(n))},r.acons=function(e,n,t){return r.cons(r.cons(e,n),t)},r.map=function(e,n){return r.isTrue(r[\"null?\"](n))?r.nil:r.cons(e(r.car(n)),r.map(e,r.cdr(n)))},r.append=function(e){var n=r._getRestArgs(arguments,1);return r.isTrue(r[\"null?\"](n))?e:r.isTrue(r[\"null?\"](e))?r.apply(r.append,n):r.cons(r.car(e),r.apply(r.append,r.cdr(e),n))},r.reverse=function(e){return function(n){return(n=function(e,t){return r.isTrue(r[\"pair?\"](e))?n(r.cdr(e),r.cons(r.car(e),t)):t})(e,r.nil)}(r.nil)},r[\"list*\"]=function(){var e=r._getRestArgs(arguments,0);return r.isTrue(r[\"null?\"](e))?r.nil:r.isTrue(r[\"null?\"](r.cdr(e)))?r.car(e):function(n){return(n=function(t,i){return r.isTrue(r[\"null?\"](r.cdr(i)))?(r[\"set-cdr!\"](t,r.car(i)),e):n(i,r.cdr(i))})(e,r.cdr(e))}(r.nil)},r[\"last-pair\"]=function(e){return r.isTrue(r[\"pair?\"](r.cdr(e)))?r[\"last-pair\"](r.cdr(e)):e},r[\"proper-list?\"]=function(e){return r.isTrue(r[\"pair?\"](e))?r[\"null?\"](r.cdr(r[\"last-pair\"](e))):r.nil},r[\"dotted->proper\"]=function(e){return r.isTrue(r[\"pair?\"](e))?r.isTrue(r[\"proper-list?\"](e))?e:function(e,n){return function(t){return r[\"set-cdr!\"](n,r.list(e)),t}(r[\"reverse!\"](n))}(r.cdr(r[\"last-pair\"](e)),r.reverse(e)):r.list(e)},r[\"vector->list\"]=function(e){return function(n){return(n=function(t,i){return r.isTrue(r[\"<\"](t,0))?i:n(t-1,r.cons(r[\"vector-ref\"](e,t),i))})(r[\"vector-length\"](e)-1,r.nil)}(r.nil)},r[\"position-if\"]=function(e,n){return function(t){return(t=function(n,i){return r.isTrue(n)?r.isTrue(e(r.car(n)))?i:t(r.cdr(n),i+1):r.nil})(n,0)}(r.nil)},r.take=function(e,n){return function(t){return(t=function(e,n,i){return r.isTrue(r[\"<=\"](e,0))||r.isTrue(r[\"null?\"](n))?r[\"reverse!\"](i):t(e-1,r.cdr(n),r.cons(r.car(n),i))})(e,n,r.nil)}(r.nil)},r.drop=function(e,n){return r.isTrue(r[\"<=\"](e,0))||r.isTrue(r[\"null?\"](n))?n:r.drop(e-1,r.cdr(n))},r.elt=function(e,n){return r.car(r.drop(e,n))},r[\"remove-if\"]=function(e,n){return function(t){return(t=function(n,i){return r.isTrue(r[\"null?\"](n))?r[\"reverse!\"](i):t(r.cdr(n),r.isTrue(e(r.car(n)))?i:r.cons(r.car(n),i))})(n,r.nil)}(r.nil)},r[\"register-macro\"](r.intern(\"dotimes\"),function(e){var n=r._getRestArgs(arguments,1);return function(){var t=r.list(0),i=r.list(1);return function(u,o,c){return r.list(r.intern(\"let1\"),o,r.cadr(e),r.list(r.intern(\"let\"),c,r.list(r[\"list*\"](u,t)),r.list(r.intern(\"if\"),r.list(r.intern(\"<\"),u,o),r[\"list*\"](r.intern(\"progn\"),r.append(n,r.list(r.list(c,r[\"list*\"](r.intern(\"+\"),u,i))))),r.caddr(e))))}}()(r.car(e),r.gensym(),r.gensym())}),r[\"register-macro\"](r.intern(\"dolist\"),function(e){var n=r._getRestArgs(arguments,1);return function(t,i,u){return r.list(r.intern(\"let\"),i,r.list(r.list(u,r.cadr(e))),r.list(r.intern(\"let1\"),t,r.list(r.intern(\"car\"),u),r[\"list*\"](r.intern(\"when\"),t,r.append(n,r.list(r.list(i,r.list(r.intern(\"cdr\"),u)))))))}(r.car(e),r.gensym(),r.gensym())}),r[\"register-macro\"](r.intern(\"flet\"),function(e){var n=r._getRestArgs(arguments,1);return r[\"list*\"](r.intern(\"let\"),r.map(function(e){return r.list(r.car(e),r[\"list*\"](r.intern(\"lambda\"),r.cdr(e)))},e),n)}),r[\"register-macro\"](r.intern(\"labels\"),function(e){var n=r._getRestArgs(arguments,1);return r[\"list*\"](r.intern(\"let\"),r.map(function(e){return r.car(e)},e),r.append(r.map(function(e){return r.list(r.intern(\"set!\"),r.car(e),r[\"list*\"](r.intern(\"lambda\"),r.cdr(e)))},e),n))}),r[\"register-macro\"](r.intern(\"deftype?\"),function(){var e=r._getRestArgs(arguments,0);return r[\"list*\"](r.intern(\"progn\"),r.map(function(){var e=r.list(r.intern(\"x\")),n=r.list(r.intern(\"type\"),r.intern(\"x\"));return function(t){return r.list(r.intern(\"defun\"),r.intern(r[\"string-append\"](t,\"?\")),e,r.list(r.intern(\"eq?\"),n,r.list(r.intern(\"quote\"),t)))}}(),e))}),r[\"symbol?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"symbol\"))},r[\"pair?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"pair\"))},r[\"number?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"number\"))},r[\"string?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"string\"))},r[\"keyword?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"keyword\"))},r[\"vector?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"vector\"))},r[\"table?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"table\"))},r[\"regexp?\"]=function(e){return r[\"eq?\"](r.type(e),r.intern(\"regexp\"))}}},function(r,e,n){\"use strict\";r.exports=function(r){r.nreconc=function(e,n){return function(t){return r[\"set-cdr!\"](e,n),t}(r[\"reverse!\"](e))},r.any=function(e,n){return r.isTrue(r[\"null?\"](n))?r.nil:r.isTrue(e(r.car(n)))?r.t:r.any(e,r.cdr(n))},r.every=function(e,n){return r.isTrue(r[\"null?\"](n))?r.t:r.isTrue(e(r.car(n)))?r.every(e,r.cdr(n)):r.nil},r[\"*bq-clobberable*\"]=r.gensym(),r[\"*bq-quote-nil*\"]=r.list(r.intern(\"quote\"),r.nil),r[\"register-macro\"](r.intern(\"quasiquote\"),function(e){return r[\"bq-completely-process\"](e)}),r[\"bq-completely-process\"]=function(e){return r[\"bq-simplify\"](r[\"bq-process\"](e))},r[\"bq-process\"]=function(e){return r.isTrue(r.not(r[\"pair?\"](e)))?r.list(r.intern(\"quote\"),e):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"quasiquote\")))?r[\"bq-process\"](r[\"bq-completely-process\"](r.cadr(e))):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote\")))?r.cadr(e):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-splicing\")))?r.error(\",@~S after `\",r.cadr(e)):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-dot\")))?r.error(\",.~S after `\",r.cadr(e)):function(n){return(n=function(e,t){return r.isTrue(r.not(r[\"pair?\"](e)))?r.cons(r.intern(\"append\"),r.nreconc(t,r.list(r.list(r.intern(\"quote\"),e)))):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote\")))?(r.isTrue(r[\"null?\"](r.cddr(e)))?r.nil:r.error(\"Malformed ,~S\",e),r.cons(r.intern(\"append\"),r.nreconc(t,r.list(r.cadr(e))))):(r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-splicing\")))?r.error(\"Dotted ,@~S\",e):r.nil,r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-dot\")))?r.error(\"Dotted ,.~S\",e):r.nil,n(r.cdr(e),r.cons(r.bracket(r.car(e)),t)))})(e,r.nil)}(r.nil)},r.bracket=function(e){return r.isTrue(r.not(r[\"pair?\"](e)))?r.list(r.intern(\"list\"),r[\"bq-process\"](e)):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote\")))?r.list(r.intern(\"list\"),r.cadr(e)):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-splicing\")))?r.cadr(e):r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"unquote-dot\")))?r.list(r[\"*bq-clobberable*\"],r.cadr(e)):r.list(r.intern(\"list\"),r[\"bq-process\"](e))},r.maptree=function(e,n){return r.isTrue(r.not(r[\"pair?\"](n)))?e(n):function(e,t){return r.isTrue(r[\"equal?\"](e,r.car(n)))&&r.isTrue(r[\"equal?\"](t,r.cdr(n)))?n:r.cons(e,t)}(e(r.car(n)),r.maptree(e,r.cdr(n)))},r[\"bq-splicing-frob\"]=function(e){return r.isTrue(r[\"pair?\"](e))?function(n){return r.isTrue(n)?n:r[\"eq?\"](r.car(e),r.intern(\"unquote-dot\"))}(r[\"eq?\"](r.car(e),r.intern(\"unquote-splicing\"))):r.nil},r[\"bq-frob\"]=function(e){return r.isTrue(r[\"pair?\"](e))?function(n){return r.isTrue(n)?n:function(n){return r.isTrue(n)?n:r[\"eq?\"](r.car(e),r.intern(\"unquote-dot\"))}(r[\"eq?\"](r.car(e),r.intern(\"unquote-splicing\")))}(r[\"eq?\"](r.car(e),r.intern(\"unquote\"))):r.nil},r[\"bq-simplify\"]=function(e){return r.isTrue(r[\"pair?\"](e))?function(e){return r.isTrue(r.not(r[\"eq?\"](r.car(e),r.intern(\"append\"))))?e:r[\"bq-simplify-args\"](e)}(r.isTrue(r[\"eq?\"](r.car(e),r.intern(\"quote\")))?e:r.maptree(r[\"bq-simplify\"],e)):e},r[\"bq-simplify-args\"]=function(e){return function(n){return(n=function(e,t){return r.isTrue(r.not(r[\"null?\"](e)))?n(r.cdr(e),r.isTrue(r.not(r[\"pair?\"](r.car(e))))?r[\"bq-attach-append\"](r.intern(\"append\"),r.car(e),t):r.isTrue(r[\"eq?\"](r.caar(e),r.intern(\"list\")))&&r.isTrue(r.not(r.any(r[\"bq-splicing-frob\"],r.cdar(e))))?r[\"bq-attach-conses\"](r.cdar(e),t):r.isTrue(r[\"eq?\"](r.caar(e),r.intern(\"list*\")))&&r.isTrue(r.not(r.any(r[\"bq-splicing-frob\"],r.cdar(e))))?r[\"bq-attach-conses\"](r.reverse(r.cdr(r.reverse(r.cdar(e)))),r[\"bq-attach-append\"](r.intern(\"append\"),r.car(r.last(r.car(e))),t)):r.isTrue(r[\"eq?\"](r.caar(e),r.intern(\"quote\")))&&r.isTrue(r[\"pair?\"](r.cadar(e)))&&r.isTrue(r.not(r[\"bq-frob\"](r.cadar(e))))&&r.isTrue(r.not(r.cddar(e)))?r[\"bq-attach-conses\"](r.list(r.list(r.intern(\"quote\"),r.caadar(e))),t):r.isTrue(r[\"eq?\"](r.caar(e),r[\"*bq-clobberable*\"]))?r[\"bq-attach-append\"](r.intern(\"append!\"),r.cadar(e),t):r[\"bq-attach-append\"](r.intern(\"append\"),r.car(e),t)):t})(r.reverse(r.cdr(e)),r.nil)}(r.nil)},r[\"null-or-quoted\"]=function(e){return function(n){return r.isTrue(n)?n:r.isTrue(r[\"pair?\"](e))?r[\"eq?\"](r.car(e),r.intern(\"quote\")):r.nil}(r[\"null?\"](e))},r[\"bq-attach-append\"]=function(e,n,t){return r.isTrue(r[\"null-or-quoted\"](n))&&r.isTrue(r[\"null-or-quoted\"](t))?r.list(r.intern(\"quote\"),r.append(r.cadr(n),r.cadr(t))):r.isTrue(r[\"null?\"](t))||r.isTrue(r[\"equal?\"](t,r[\"*bq-quote-nil*\"]))?r.isTrue(r[\"bq-splicing-frob\"](n))?r.list(e,n):n:r.isTrue(r[\"pair?\"](t))&&r.isTrue(r[\"eq?\"](r.car(t),e))?r[\"list*\"](r.car(t),n,r.cdr(t)):r.list(e,n,t)},r[\"bq-attach-conses\"]=function(e,n){return r.isTrue(r.every(r[\"null-or-quoted\"],e))&&r.isTrue(r[\"null-or-quoted\"](n))?r.list(r.intern(\"quote\"),r.append(r.map(r.cadr,e),r.cadr(n))):r.isTrue(r[\"null?\"](n))||r.isTrue(r[\"equal?\"](n,r[\"*bq-quote-nil*\"]))?r.cons(r.intern(\"list\"),e):r.isTrue(r[\"pair?\"](n))&&(r.isTrue(r[\"eq?\"](r.car(n),r.intern(\"list\")))||r.isTrue(r[\"eq?\"](r.car(n),r.intern(\"list*\"))))?r.cons(r.car(n),r.append(e,r.cdr(n))):r.cons(r.intern(\"list*\"),r.append(e,r.list(n)))}}},function(r,e,n){\"use strict\";r.exports=function(r){r[\"create-scope\"]=function(e,n){return r.vector(r[\"remove-if\"](function(){var e=r.list(r.intern(\"&rest\"),r.intern(\"&body\"));return function(n){return r.member(n,e)}}(),n),r.nil,e)},r[\"scope-param\"]=function(e){return r[\"vector-ref\"](e,0)},r[\"scope-outer\"]=function(e){return r[\"vector-ref\"](e,2)},r[\"scope-add-var\"]=function(e,n){return function(t){return r[\"vector-set!\"](e,1,r.cons(r.cons(t,n),r[\"vector-ref\"](e,1))),r[\"vector-set!\"](e,0,r.cons(t,r[\"vector-ref\"](e,0))),t}(r.gensym())},r[\"scope-get-var\"]=function(e){return r[\"vector-ref\"](e,1)},r[\"scope-var?\"]=function(e,n){return r.isTrue(r[\"null?\"](e))?r.nil:r.isTrue(r.member(n,r[\"scope-param\"](e)))?r.t:r[\"scope-var?\"](r[\"scope-outer\"](e),n)},r[\"local-var?\"]=function(e,n){return r.isTrue(r[\"symbol?\"](n))?r[\"scope-var?\"](e,r[\"get-receiver\"](n)):r.nil},r[\"special-var?\"]=function(){var e=r.list(r.intern(\"this\"));return function(n,t){return r.member(t,e)}}(),r[\"get-receiver\"]=function(e){return function(n){return function(t){return r.isTrue(t)?r.intern(r.substring(n,0,t)):e}(r[\"string-scan\"](n,\".\"))}(r[\"symbol->string\"](e))},r[\"register-macro\"](r.intern(\"record\"),function(e,n){var t=r._getRestArgs(arguments,2);return r.list(r.intern(\"apply\"),r[\"list*\"](r.intern(\"lambda\"),n,t),e)}),r[\"register-macro\"](r.intern(\"record-case\"),function(e){var n=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern(\"let1\"),t,e,r[\"list*\"](r.intern(\"case\"),r.list(r.intern(\"car\"),t),r.map(function(e){return r.isTrue(r[\"eq?\"](r.car(e),r.t))?e:function(n){return r.list(r.list(n),r[\"list*\"](r.intern(\"record\"),r.list(r.intern(\"cdr\"),t),r.cdar(e),r.cdr(e)))}(r.caar(e))},n)))}(r.gensym())}),r[\"parse-quoted-value\"]=function(e){return r.isTrue(r[\"pair?\"](e))?r.isTrue(r[\"proper-list?\"](e))?r.vector(r[\"make-keyword\"](\"FUNCALL\"),r.vector(r[\"make-keyword\"](\"REF\"),r.intern(\"list\")),r.map(r[\"parse-quoted-value\"],e)):r.vector(r[\"make-keyword\"](\"FUNCALL\"),r.vector(r[\"make-keyword\"](\"REF\"),r.isTrue(r[\"pair?\"](r.cdr(e)))?r.intern(\"list*\"):r.intern(\"cons\")),r.map(r[\"parse-quoted-value\"],r[\"dotted->proper\"](e))):r.isTrue(r[\"vector?\"](e))?r.vector(r[\"make-keyword\"](\"FUNCALL\"),r.vector(r[\"make-keyword\"](\"REF\"),r.intern(\"vector\")),r.map(r[\"parse-quoted-value\"],r[\"vector->list\"](e))):r.vector(r[\"make-keyword\"](\"CONST\"),e)},function(e){(function(n){n=function(e){return r.isTrue(e)?r.isTrue(r[\"symbol?\"](r.car(e)))?n(r.cdr(e)):r[\"compile-error\"](\"function parameter must be symbol, but\",r.car(e)):r.nil},r[\"parse-list\"]=function(t,i){return function(u){return function(o){return r.isTrue(r[\"eq?\"](o,r.intern(\"quote\")))?r.apply(function(e){return r.isTrue(r[\"pair?\"](e))||r.isTrue(r[\"vector?\"](e))?r.vector(r[\"make-keyword\"](\"REF\"),r[\"scope-add-var\"](i,r[\"parse-quoted-value\"](e))):r.vector(r[\"make-keyword\"](\"CONST\"),e)},r.cdr(u)):r.isTrue(r[\"eq?\"](o,r.intern(\"if\")))?r.apply(function(e,n){var t=r._getRestArgs(arguments,2);return r.vector(r[\"make-keyword\"](\"IF\"),r[\"parse*\"](e,i),r[\"parse*\"](n,i),r.isTrue(r[\"null?\"](t))?r.nil:r[\"parse*\"](r.car(t),i))},r.cdr(u)):r.isTrue(r[\"eq?\"](o,r.intern(\"set!\")))?r.apply(function(e,n){return r.vector(r[\"make-keyword\"](\"SET!\"),r[\"parse*\"](e,i),r[\"parse*\"](n,i))},r.cdr(u)):r.isTrue(r[\"eq?\"](o,r.intern(\"lambda\")))?r.apply(function(t){var u=r._getRestArgs(arguments,1);return n(t),function(n){return r.vector(r[\"make-keyword\"](\"LAMBDA\"),n,t,e(u,n))}(r[\"create-scope\"](i,t))},r.cdr(u)):r.isTrue(r[\"eq?\"](o,r.intern(\"def\")))?r.apply(function(e,n){return r.vector(r[\"make-keyword\"](\"DEF\"),r[\"parse*\"](e,i),r[\"parse*\"](n,i))},r.cdr(u)):r.isTrue(r[\"null?\"](t))||r.isTrue(r[\"proper-list?\"](t))?r.vector(r[\"make-keyword\"](\"FUNCALL\"),r[\"parse*\"](r.car(t),i),e(r.cdr(t),i)):r[\"compile-error\"](\"funcall must be proper list, but\",t)}(r.car(u))}(t)}})(r.nil)}(function(e,n){return r.map(function(e){return r[\"parse*\"](e,n)},e)}),r[\"parse*\"]=function(e,n){return r.isTrue(r[\"pair?\"](e))?r.isTrue(r[\"local-var?\"](n,r.car(e)))?r[\"parse-list\"](e,n):function(e){return r.isTrue(r[\"pair?\"](e))?r[\"parse-list\"](e,n):r[\"parse*\"](e,n)}(r.macroexpand(e)):r.isTrue(r[\"symbol?\"](e))?r.vector(r[\"make-keyword\"](\"REF\"),e):r[\"parse-quoted-value\"](e)},r.parse=function(e){return r[\"parse*\"](e,r[\"create-scope\"](r.nil,r.nil))}}},function(r,e,n){\"use strict\";r.exports=function(r){r[\"expand-args\"]=function(e,n){return r[\"string-join\"](r.map(function(e){return r[\"compile*\"](e,n)},e),\", \")},r[\"expand-body\"]=function(e,n){return r.isTrue(r[\"null?\"](e))?\"LISP.nil\":r[\"expand-args\"](e,n)},function(e){r[\"hash-table-put!\"](e,\"\\\\\",\"\\\\\\\\\"),r[\"hash-table-put!\"](e,\"\\t\",\"\\\\t\"),r[\"hash-table-put!\"](e,\"\\n\",\"\\\\n\"),r[\"hash-table-put!\"](e,'\"','\\\\\"'),r[\"escape-char\"]=function(n){return function(e){return r.isTrue(e)?e:n}(r[\"hash-table-get\"](e,n))}}(r[\"make-hash-table\"]()),r[\"escape-string\"]=function(e){return r[\"regexp-replace-all\"](/[\\\\\\t\\n\"]/,e,function(e){return r[\"escape-char\"](e())})},r[\"escape-sym-char\"]=function(e){return r[\"string-append\"](\"$\",r[\"integer->hex-string\"](r[\"char->number\"](e),\"00\"))},r[\"integer->hex-string\"]=function(e,n){return function(e){return function(t){return function(n){return r.substring(e,t-n,t)}(r[\"string-length\"](n))}(r[\"string-length\"](e))}(r[\"string-append\"](n,r[\"number->string\"](e,16)))},function(){var e=r.list(r.intern(\"null\"),r.intern(\"true\"),r.intern(\"false\"),r.intern(\"break\"),r.intern(\"case\"),r.intern(\"catch\"),r.intern(\"continue\"),r.intern(\"debugger\"),r.intern(\"default\"),r.intern(\"delete\"),r.intern(\"do\"),r.intern(\"else\"),r.intern(\"finally\"),r.intern(\"for\"),r.intern(\"function\"),r.intern(\"if\"),r.intern(\"in\"),r.intern(\"instanceof\"),r.intern(\"new\"),r.intern(\"return\"),r.intern(\"switch\"),r.intern(\"throw\"),r.intern(\"try\"),r.intern(\"typeof\"),r.intern(\"var\"),r.intern(\"void\"),r.intern(\"while\"),r.intern(\"with\"));r[\"JS-RESERVED-WORDS\"]=e}(),r[\"escape-param-name\"]=function(e){return r.isTrue(r.member(e,r[\"JS-RESERVED-WORDS\"]))?r[\"string-append\"](\"__\",r[\"symbol->string\"](e)):r[\"regexp-replace-all\"](/[^0-9A-Za-z_.]/,r[\"symbol->string\"](e),function(e){return r[\"escape-sym-char\"](r[\"string-ref\"](e(),0))})},r[\"compile-symbol\"]=function(e,n){return r.isTrue(r[\"local-var?\"](n,e))||r.isTrue(r[\"special-var?\"](n,e))?r[\"escape-param-name\"](e):function(e){return r.isTrue(r.rxmatch(/^[0-9A-Za-z_.]*$/,e))?r[\"string-append\"](\"LISP.\",e):r[\"string-append\"]('LISP[\"',r[\"escape-string\"](e),'\"]')}(r[\"symbol->string\"](e))},r[\"compile-keyword\"]=function(e){return r[\"string-append\"]('LISP[\"make-keyword\"](\"',r[\"escape-string\"](r[\"keyword->string\"](e)),'\")')},r[\"compile-vector\"]=function(e,n){return r[\"string-append\"](\"[\",r[\"string-join\"](r.map(function(e){return r[\"compile-quote\"](e,n)},r[\"vector->list\"](e)),\", \"),\"]\")},r[\"compile-regexp\"]=function(e){return r[\"string-append\"](\"/\",r[\"regexp->string\"](e),\"/\")},r[\"compile-literal\"]=function(e,n){return r.isTrue(r[\"number?\"](e))?r[\"number->string\"](e):r.isTrue(r[\"symbol?\"](e))?r[\"compile-symbol\"](e,n):r.isTrue(r[\"keyword?\"](e))?r[\"compile-keyword\"](e):r.isTrue(r[\"string?\"](e))?r[\"x->string\"](e,r.t):r.isTrue(r[\"vector?\"](e))?r[\"compile-vector\"](e,n):r.isTrue(r[\"regexp?\"](e))?r[\"compile-regexp\"](e):r.isTrue(r[\"null?\"](e))?\"LISP.nil\":r.isTrue(r[\"eq?\"](e,r.t))?\"LISP.t\":r.error(r[\"string-append\"](\"compile-literal: [\",e,\"]\"))},r[\"compile-unary-op\"]=function(e,n,t){return r[\"string-append\"](\"(\",r[\"symbol->string\"](e),r[\"compile*\"](n,t),\")\")},r[\"compile-binop\"]=function(e,n,t){return r[\"string-append\"](\"(\",r[\"string-join\"](r.map(function(e){return r[\"compile*\"](e,t)},n),r[\"string-append\"](\" \",r[\"symbol->string\"](e),\" \")),\")\")},function(e,n,t){r[\"compile-funcall\"]=function(i,u,o){return r.isTrue(r[\"eq?\"](r[\"vector-ref\"](i,0),r[\"make-keyword\"](\"REF\")))&&r.isTrue(r.not(r[\"local-var?\"](o,r[\"vector-ref\"](i,1))))&&r.isTrue(r.not(r[\"null?\"](u)))?function(c){return r.isTrue(t(c))&&r.isTrue(r.not(r[\"null?\"](r.cdr(u))))?r[\"compile-binop\"](c,u,o):r.isTrue(n(c))&&r.isTrue(r[\"null?\"](r.cdr(u)))?r[\"compile-unary-op\"](c,r.car(u),o):e(i,u,o)}(r[\"vector-ref\"](i,1)):e(i,u,o)}}(function(e,n,t){return r[\"string-append\"](r[\"compile*\"](e,t),\"(\",r[\"expand-args\"](n,t),\")\")},function(){var e=r.list(r.intern(\"+\"),r.intern(\"-\"),r.intern(\"!\"),r.intern(\"~\"));return function(n){return r.member(n,e)}}(),function(){var e=r.list(r.intern(\"+\"),r.intern(\"-\"),r.intern(\"*\"),r.intern(\"/\"),r.intern(\"%\"));return function(n){return r.member(n,e)}}()),r[\"compile-quote\"]=function(e,n){return r.isTrue(r[\"pair?\"](e))?r[\"compile*\"](r.list(r.intern(\"cons\"),r.list(r.intern(\"quote\"),r.car(e)),r.list(r.intern(\"quote\"),r.cdr(e))),n):r.isTrue(r[\"symbol?\"](e))?r[\"string-append\"]('LISP.intern(\"',r[\"escape-string\"](r[\"symbol->string\"](e)),'\")'):r.isTrue(r[\"keyword?\"](e))?r[\"compile-keyword\"](e):r[\"compile-literal\"](e,n)},function(e){(function(n){n=function(t,i){return r.isTrue(e(r[\"make-keyword\"](\"IF\"),t))&&r.isTrue(function(n){return function(t){return r.isTrue(t)?t:r.isTrue(e(r[\"make-keyword\"](\"CONST\"),n))?r[\"eq?\"](r[\"vector-ref\"](n,1),r.nil):r.nil}(r.not(n))}(r[\"vector-ref\"](t,3)))?r[\"string-append\"](\"(\",n(r[\"vector-ref\"](t,1),i),\" && \",n(r[\"vector-ref\"](t,2),i),\")\"):r.isTrue(e(r[\"make-keyword\"](\"FUNCALL\"),t))&&r.isTrue(e(r[\"make-keyword\"](\"LAMBDA\"),r[\"vector-ref\"](t,1)))&&r.isTrue(r[\"eq?\"](r.length(r[\"scope-param\"](r[\"vector-ref\"](r[\"vector-ref\"](t,1),1))),1))&&r.isTrue(r[\"eq?\"](r.length(r[\"vector-ref\"](t,2)),1))&&r.isTrue(r[\"eq?\"](r.length(r[\"vector-ref\"](r[\"vector-ref\"](t,1),3)),1))&&r.isTrue(function(n){return e(r[\"make-keyword\"](\"IF\"),n),e(r[\"make-keyword\"](\"REF\"),r[\"vector-ref\"](n,1)),r[\"eq?\"](r[\"vector-ref\"](r[\"vector-ref\"](n,1),1),r.car(r[\"scope-param\"](r[\"vector-ref\"](r[\"vector-ref\"](t,1),1)))),r[\"equal?\"](r[\"vector-ref\"](n,1),r[\"vector-ref\"](n,2))}(r.car(r[\"vector-ref\"](r[\"vector-ref\"](t,1),3))))?function(e){return function(e,t){return r.isTrue(r[\"null?\"](t))||r.isTrue(r[\"eq?\"](r[\"vector-ref\"](t,0),r[\"make-keyword\"](\"CONST\")))&&r.isTrue(r[\"eq?\"](r[\"vector-ref\"](t,1),r.nil))?n(e,i):r[\"string-append\"](\"(\",n(e,i),\" || \",n(t,i),\")\")}(r.car(r[\"vector-ref\"](t,2)),r[\"vector-ref\"](e,3))}(r.car(r[\"vector-ref\"](r[\"vector-ref\"](t,1),3))):r[\"string-append\"](\"LISP.isTrue(\",r[\"compile*\"](t,i),\")\")},r[\"compile-if\"]=function(e,t,i,u){return r[\"string-append\"](\"(\",n(e,u),\" ? \",r[\"compile*\"](t,u),\" : \",r.isTrue(i)?r[\"compile*\"](i,u):\"LISP.nil\",\")\")}})(r.nil)}(function(e,n){return r[\"eq?\"](r[\"vector-ref\"](n,0),e)}),r[\"compile-set!\"]=function(e,n,t){return r[\"string-append\"](r[\"compile*\"](e,t),\" = \",r[\"compile*\"](n,t))},r[\"compile-lambda\"]=function(e,n,t,i,u){return r.isTrue(r[\"null?\"](n))||r.isTrue(r[\"pair?\"](n))?r.nil:r.error(\"function parameters must be a list\"),function(i){return function(n,i){return r[\"string-append\"](\"(function \",r.isTrue(r[\"null?\"](e))?\"\":r[\"escape-param-name\"](e),\"(\",r[\"string-join\"](r.map(function(e){return r[\"escape-param-name\"](e)},n),\", \"),\"){\",r.isTrue(r[\"null?\"](i))?\"\":r[\"string-append\"](\"var \",r[\"escape-param-name\"](i),\" = LISP._getRestArgs(arguments, \",r[\"number->string\"](r.length(n)),\"); \"),\"return (\",r[\"expand-body\"](t,u),\");})\")}(r.isTrue(i)?r.take(i,n):n,r.isTrue(i)?r.elt(i+1,n):r.nil)}(r[\"position-if\"](function(){var e=r.list(r.intern(\"&rest\"),r.intern(\"&body\"));return function(n){return r.member(n,e)}}(),n))},r[\"compile-def\"]=function(e,n,t){return r[\"string-append\"](r[\"compile*\"](e,t),\" = \",r.isTrue(r[\"eq?\"](r[\"vector-ref\"](n,0),r[\"make-keyword\"](\"LAMBDA\")))?r[\"compile-lambda-node\"](n,r[\"vector-ref\"](e,1)):r[\"compile*\"](n,t))},r[\"compile-new-scope\"]=function(e,n){return function(t){return r.isTrue(t)?r[\"string-append\"](\"(function() { var \",r[\"string-join\"](r.map(function(e){return r[\"string-append\"](r[\"escape-param-name\"](r.car(e)),\" = \",r[\"compile*\"](r.cdr(e),n))},r.reverse(t)),\", \"),\"; return \",e,\"; })()\"):e}(r[\"scope-get-var\"](n))},r[\"compile-lambda-node\"]=function(e,n,t){return function(e,i,u){return r[\"compile-new-scope\"](r[\"compile-lambda\"](n,i,u,t,e),e)}(r[\"vector-ref\"](e,1),r[\"vector-ref\"](e,2),r[\"vector-ref\"](e,3))},r[\"compile*\"]=function(e,n){return function(t){return r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"CONST\")))?r[\"compile-quote\"](r[\"vector-ref\"](e,1),n):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"REF\")))?r[\"compile-symbol\"](r[\"vector-ref\"](e,1),n):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"IF\")))?function(e,t,i){return r[\"compile-if\"](e,t,i,n)}(r[\"vector-ref\"](e,1),r[\"vector-ref\"](e,2),r[\"vector-ref\"](e,3)):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"FUNCALL\")))?r[\"compile-funcall\"](r[\"vector-ref\"](e,1),r[\"vector-ref\"](e,2),n):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"SET!\")))?r[\"compile-set!\"](r[\"vector-ref\"](e,1),r[\"vector-ref\"](e,2),n):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"LAMBDA\")))?r[\"compile-lambda-node\"](e,r.nil,n):r.isTrue(r[\"eq?\"](t,r[\"make-keyword\"](\"DEF\")))?r[\"compile-def\"](r[\"vector-ref\"](e,1),r[\"vector-ref\"](e,2),n):r[\"compile-error\"](\"Unknown AST node:\",e)}(r[\"vector-ref\"](e,0))},r[\"compile-error\"]=function(){var e=r._getRestArgs(arguments,0);return r.error(e)},r.compile=function(e){return function(n){return function(e){return r[\"compile-new-scope\"](r[\"compile*\"](e,n),n)}(r[\"parse*\"](e,n))}(r[\"create-scope\"](r.nil,r.nil))}}},function(r,e,n){\"use strict\";r.exports=function(r){r[\"*version*\"]=\"0.1.0\"}}]);"],"mappings":"AAAA","sourceRoot":""}