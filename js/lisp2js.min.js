"use strict";function _possibleConstructorReturn(r,n){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!==("undefined"==typeof n?"undefined":_typeof2(n))&&"function"!=typeof n?r:n}function _inherits(r,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof n?"undefined":_typeof2(n)));r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n)}function _classCallCheck(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":typeof r},_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(r){return"undefined"==typeof r?"undefined":_typeof2(r)}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol?"symbol":"undefined"==typeof r?"undefined":_typeof2(r)},_createClass=function(){function r(r,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}return function(n,e,t){return e&&r(n.prototype,e),t&&r(n,t),n}}();!function(r,n,e){var t="undefined"!=typeof window?window:"undefined"!=typeof GLOBAL?GLOBAL:{},i=r(t);if(n(i),e(i),"undefined"!=typeof module?module.exports=i:t.LISP=i,"undefined"!=typeof document){var u=function(){var r=document.currentScript||function(){var r=document.getElementsByTagName("script");return r.item(r.length-1)}();return r.text},c=function(r){for(var n=new i.StrStream(r);;){var e=i.read(n);if(void 0===e)break;i.eval(e)}};c(u())}}(function(r){var n={},e=function(r){for(var e=n.nil,t=r.length;--t>=0;)e=n.cons(r[t],e);return e},t=function(r){return r?n.t:n.nil},i=function T(r,e){return r===n.nil?"nil":r===n.t?"t":"string"==typeof r?e?l(r):r:r instanceof Array?"#("+r.map(function(r){return T(r,e)}).join(" ")+")":null==r?""+r:r.toString(e)};n.nil=!1,n.t=!0,n.isTrue=function(r){return r!==n.nil&&null!=r},n._getRestArgs=function(r,n){return e(Array.prototype.slice.call(r,n))},n._output="undefined"!=typeof process?function(r){process.stdout.write(r)}:function(r){console.log(r)},!function(){var r={};n["register-macro"]=function(n,e){return r[n]=e,n},n["macroexpand-1"]=function(e){if(!(n["pair?"](e)&&e.car in r))return e;var t=r[e.car];return n.apply(t,e.cdr)}}(),n.error=function(){throw Array.prototype.slice.call(arguments).join(", ")};var u=function q(){_classCallCheck(this,q)},c=function(r){function n(r){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return e.name=r,e}return _inherits(n,r),_createClass(n,[{key:"toString",value:function(){return this.name}}],[{key:"getTypeName",value:function(){return"symbol"}}]),n}(u);n["symbol->string"]=function(r){return r.name},!function(){var r={};n.intern=function(n){return n in r?r[n]:r[n]=new c(n)}}(),!function(){var r=0;n.gensym=function(){return n.intern("__"+ ++r)}}();var o=function(r){function n(r){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return e.name=r,e}return _inherits(n,r),_createClass(n,[{key:"toString",value:function(r){return r?":"+this.name:this.name}}],[{key:"getTypeName",value:function(){return"keyword"}}]),n}(u);!function(){var r={};n["make-keyword"]=function(n){return n in r?r[n]:r[n]=new o(n)}}(),n["keyword->string"]=function(r){return r.name},n.type=function(r){var e=void 0;return r===n.nil||r===n.t?e="bool":(e="undefined"==typeof r?"undefined":_typeof(r),"object"===e&&(r instanceof Array&&(e="vector"),r instanceof RegExp?e="regexp":r instanceof u&&(e=r.constructor.getTypeName()))),n.intern(e)},n["eq?"]=function(r,n){return t(r===n)};var s=function(r){function e(r,n,t,i){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,Object.getPrototypeOf(e).call(this));return u.car=r,u.cdr=n,null!=t&&(u.lineNo=t,u.path=i),u}return _inherits(e,r),_createClass(e,[{key:"toString",value:function(r){var t=e.canAbbrev(this);if(t)return""+t+i(this.cdr.car,r);var u=[],c="(",o=void 0;for(o=this;o instanceof e;o=o.cdr)u.push(c),u.push(i(o.car,r)),c=" ";return o!==n.nil&&(u.push(" . "),u.push(i(o,r))),u.push(")"),u.join("")}},{key:"toArray",value:function(){for(var r=[],n=this;n instanceof e;n=n.cdr)r.push(n.car);return r}}],[{key:"getTypeName",value:function(){return"pair"}},{key:"canAbbrev",value:function(r){var t={quote:"'",quasiquote:"`",unquote:",","unquote-splicing":",@"};return r.car instanceof c&&r.car.name in t&&r.cdr instanceof e&&n["eq?"](r.cdr.cdr,n.nil)?t[r.car.name]:!1}}]),e}(u);n.cons=function(r,n){return new s(r,n)},n.car=function(r){return r instanceof s?r.car:r},n.cdr=function(r){return r instanceof s?r.cdr:n.nil},n["set-car!"]=function(r,n){return r.car=n},n["set-cdr!"]=function(r,n){return r.cdr=n},n.list=function(){for(var r=n.nil,e=arguments.length;--e>=0;)r=n.cons(arguments[e],r);return r},n["reverse!"]=function(r){for(var e=n.nil,t=r;n["pair?"](t);){var i=t.cdr;t.cdr=e,e=t,t=i}return e},n["number->string"]=function(r,n){return r.toString(n)},n["+"]=function(){if(0==arguments.length)return 0;for(var r=arguments[0],n=1;n<arguments.length;++n)r+=arguments[n];return r},n["*"]=function(){if(0==arguments.length)return 1;for(var r=arguments[0],n=1;n<arguments.length;++n)r*=arguments[n];return r},n["-"]=function(){if(0==arguments.length)return 0;var r=arguments[0];if(1==arguments.length)return-r;for(var n=1;n<arguments.length;++n)r-=arguments[n];return r},n["/"]=function(){if(0==arguments.length)return 1;var r=arguments[0];if(1==arguments.length)return 1/r;for(var n=1;n<arguments.length;++n)r/=arguments[n];return r},n["%"]=function(){if(0==arguments.length)return 0;var r=arguments[0];if(1==arguments.length)return r;for(var n=1;n<arguments.length;++n)r%=arguments[n];return r},n["<"]=function(){if(arguments.length>0)for(var r=arguments[0],e=1;e<arguments.length;++e){var t=arguments[e];if(!(t>r))return n.nil;r=t}return n.t},n[">"]=function(){if(arguments.length>0)for(var r=arguments[0],e=1;e<arguments.length;++e){var t=arguments[e];if(!(r>t))return n.nil;r=t}return n.t},n["<="]=function(){if(arguments.length>0)for(var r=arguments[0],e=1;e<arguments.length;++e){var t=arguments[e];if(!(t>=r))return n.nil;r=t}return n.t},n[">="]=function(){if(arguments.length>0)for(var r=arguments[0],e=1;e<arguments.length;++e){var t=arguments[e];if(!(r>=t))return n.nil;r=t}return n.t},n["string=?"]=function(r,n){return t(r===n)},n["string-append"]=function(){return Array.prototype.slice.call(arguments).join("")},n["string-join"]=function(r,e){return r===n.nil?"":r.toArray().join(e)},n["string-length"]=function(r){return r.length},n["string-ref"]=function(r,n){return r[n]},n.substring=function(r,n,e){return r.slice(n,e)},n["string-scan"]=function(r,e){var t=r.indexOf(e);return t>=0?t:n.nil},n["char->integer"]=function(r,n){return r.charCodeAt(n)};var a={"\\":"\\\\","	":"\\t","\n":"\\n",'"':'\\"'},l=function(r){var n=function(r){return r in a?a[r]:"\\x"+("0"+r.charCodeAt(0).toString(16)).slice(-2)};return'"'+r.replace(/[\x00-\x1f\"\\]/g,n)+'"'};n["x->string"]=i,n.print=function(r,e){var t=i(r);return e?e.write(t):n._output(t),r},n.puts=function(r){return n._output(i(r)),"undefined"!=typeof process&&n._output("\n"),r},n.write=function(r){return n._output(i(r,10)),r},n.apply=function(r){for(var e=arguments.length,t=Array(e>1?e-1:0),i=1;e>i;i++)t[i-1]=arguments[i];if(t.length>0){var u=t.pop();u!==n.nil&&(t=t.concat(u.toArray()))}return r.apply(null,t)},n.JS=r;var f=function(r){function n(){return _classCallCheck(this,n),_possibleConstructorReturn(this,Object.getPrototypeOf(n).apply(this,arguments))}return _inherits(n,r),_createClass(n,[{key:"toString",value:function(){var r="";for(var n in this)this.hasOwnProperty(n)&&(r.length>0&&(r+=", "),r+=n+":"+this[n]);return"#table<"+r+">"}}],[{key:"getTypeName",value:function(){return"table"}}]),n}(u);n.HashTable=f,n["make-hash-table"]=function(){return new f},n["hash-table-exists?"]=function(r,e){return e in r?n.t:n.nil},n["hash-table-get"]=function(r,e){var t=arguments.length<=2||void 0===arguments[2]?n.nil:arguments[2];return e in r?r[e]:t},n["hash-table-put!"]=function(r,n,e){return r[n]=e},n.vector=function(){return Array.prototype.slice.call(arguments)},n["make-vector"]=function(r,e){void 0===e&&(e=n.nil);for(var t=new Array(r),i=0;r>i;++i)t[i]=e;return t},n["vector-length"]=function(r){return r.length},n["vector-ref"]=function(r,n){return r[n]},n["vector-set!"]=function(r,n,e){return r[n]=e},n.rxmatch=function(r,n){return t(r.exec(n))},n["regexp-replace-all"]=function(r,n,e){if(!r.global){var t=r.toString(),i=t.lastIndexOf("/");r=new RegExp(t.slice(1,i),t.slice(i+1)+"g")}return n.replace(r,function(r){return e(function(){return r})})},n["regexp->string"]=function(r){var n=r.toString();return n.slice(1,n.length-1)};var p=function(r){function n(){_classCallCheck(this,n);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return r.str="",r.lineNo=0,r}return _inherits(n,r),_createClass(n,[{key:"close",value:function(){}},{key:"peek",value:function(){var r=this.fetch();return null==r?r:this.str[0]}},{key:"getc",value:function(){var r=this.peek();return null==r?r:(this.str=this.str.slice(1),r)}},{key:"ungetc",value:function(r){this.str?this.str=r+this.str:this.str=r}},{key:"match",value:function(r,n){var e=this.fetch();if(null==e)return e;var t=this.str.match(r);return t&&!n&&(this.str=RegExp.rightContext),t}},{key:"eof",value:function(){return null==this.str}},{key:"getLine",value:function(){var r=this.str||this.readLine();return this.str="",r}},{key:"fetch",value:function(){if(null==this.str)return null;if(""===this.str){if(null==(this.str=this.readLine()))return;++this.lineNo}return this.str}}]),n}(u),d=function(r){function n(r){_classCallCheck(this,n);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(n).call(this));return e.str=r,e.lineNo=1,e}return _inherits(n,r),_createClass(n,[{key:"readLine",value:function(){return null}}]),n}(p);n.StrStream=d,n.NoCloseParenException=function(){};var g="\\s(){}\\[\\]'`,;#\"",m=RegExp("^\\.(?=["+g+"])"),v=RegExp("^([^"+g+"]+)"),h={t:"	",n:"\n"},y={},b=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"read",value:function(n){do if(n.eof())return null;while(n.match(/^(\s+|$)/));var e=n.peek();if(e in y)return y[e](n,n.getc());var t=void 0;if(n.match(/^;[^\n]*\n?/))return r.read(n);if(t=n.match(/^"((\\.|[^"\\])*)"/))return r.unescape(t[1]);if(n.match(/^#\(/))return r.readVector(n);if(t=n.match(/^#\/([^\/]*)\//))return new RegExp(t[1]);if(n.match(/^#\|(.|[\n\r])*?\|#/))return r.read(n);if(!n.match(m,!0))return(t=n.match(v))?r.readSymbolOrNumber(t[1]):void 0}},{key:"readSymbolOrNumber",value:function(r){return"nil"===r?n.nil:"t"===r?n.t:":"===r[0]?n["make-keyword"](r.slice(1)):r.match(/^([+\-]?[0-9]+(\.[0-9]*)?)$/)?parseFloat(r):n.intern(r)}},{key:"readList",value:function(e){for(var t=n.nil;;){var i=r.read(e);if(null==i)break;t=new s(i,t,e.lineNo,e.path)}if(e.match(/^\s*\)/))return n["reverse!"](t);if(e.match(m)){var u=r.read(e);if(null!=u&&e.match(/^\s*\)/)){var c=n["reverse!"](t);return t.cdr=u,c}}throw new n.NoCloseParenException}},{key:"readVector",value:function(e){for(var t=[];;){var i=r.read(e);if(null==i)break;t.push(i)}if(e.match(/^\s*\)/))return t;throw new n.NoCloseParenException}},{key:"unescape",value:function(r){return r.replace(/\\(x([0-9a-fA-F]{2})|(.))/g,function(r,n,e,t){return e?String.fromCharCode(parseInt(e,16)):t in h?h[t]:t})}},{key:"setMacroCharacter",value:function(r,n){y[r]=n}}]),r}();return n["set-macro-character"]=b.setMacroCharacter,b.setMacroCharacter("(",function(r,n){return b.readList(r)}),n.read=function(r){return b.read(r||n["*stdin*"])},n["read-from-string"]=function(r){return b.read(new d(r))},n["read-line"]=function(r){return(r||n["*stdin*"]).getLine()},n["read-char"]=function(){var r=arguments.length<=0||void 0===arguments[0]?n["*stdin*"]:arguments[0];return r.getc()},n["unread-char"]=function(r){var e=arguments.length<=1||void 0===arguments[1]?n["*stdin*"]:arguments[1];return e.ungetc(r),n.nil},"undefined"!=typeof process&&!function(){var r=require("fs"),e=4096,t=new Buffer(e),i=function(i){function u(r,n){_classCallCheck(this,u);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(u).call(this));return e.fd=r,e.path=n,e.lines=[],e.index=0,e}return _inherits(u,i),_createClass(u,[{key:"close",value:function(){null!=this.fd&&(r.closeSync(this.fd),this.fd=null,this.lines.length=this.index=0,this.str=null,this.chomped=!1)}},{key:"readLine",value:function(){for(;;){var i="";if(this.index<this.lines.length){if(this.index<this.lines.length-1||!this.chomped)return this.lines[this.index++];this.chomped&&(i=this.lines[this.index])}if(null==this.fd)return n.nil;var u=r.readSync(this.fd,t,0,e);if(0>=u)return null;var c=i+t.slice(0,u).toString();this.chomped=!1,c.length>0&&("\n"!=c[c.length-1]?this.chomped=!0:c=c.slice(0,c.length-1)),this.lines=c.split("\n"),this.index=0}}},{key:"write",value:function(n){r.write(this.fd,n)}}]),u}(p);n.FileStream=i,n["*stdin*"]=new i(process.stdin.fd,"*stdin*"),n["*stdout*"]=new i(process.stdout.fd,"*stdout*"),n["*stderr*"]=new i(process.stderr.fd,"*stderr*"),n.open=function(e,t){try{var i=r.openSync(e,t||"r");return new n.FileStream(i,e)}catch(u){return n.nil}},n.close=function(r){return r.close(),r},n.load=function(r){var e=void 0;if("string"==typeof r){if(e=n.open(r),!e)return n.error("Cannot open ["+fileName+"]")}else{if(!(r instanceof p))return n.error("Illegal fileSpec: "+r);e=r}e.match(/^#!/,!0)&&e.getLine();for(var t=void 0;;){var i=n.read(e);if(null==i)break;t=n.eval(i)}return e!==r&&n.close(e),t},n.exit=function(r){return process.exit(r)},n.jsrequire=require}(),n},function(LISP){LISP.eval=function(exp){return eval(LISP.compile(exp))}},function(r){r["register-macro"](r.intern("defmacro"),function(n,e){var t=r._getRestArgs(arguments,2);return r.list(r.intern("register-macro"),r.list(r.intern("quote"),n),r["list*"](r.intern("lambda"),e,t))}),r.macroexpand=function(n){return function(e){return r.isTrue(r["equal?"](e,n))?n:r.macroexpand(e)}(r["macroexpand-1"](n))},r["set-macro-character"]("'",function(n,e){return r.list(r.intern("quote"),r.read(n))}),r["set-macro-character"]("`",function(n,e){return r.list(r.intern("quasiquote"),r.read(n))}),r["set-macro-character"](",",function(n,e){return function(e){return r.isTrue(r["eq?"](e,"@"))?r.list(r.intern("unquote-splicing"),r.read(n)):function(){return r["unread-char"](e,n),r.list(r.intern("unquote"),r.read(n))}()}(r["read-char"](n))}),r["register-macro"](r.intern("defun"),function(n,e){var t=r._getRestArgs(arguments,2);return r.list(r.intern("def"),n,r["list*"](r.intern("lambda"),e,t))}),r["register-macro"](r.intern("let"),function(n){var e=r._getRestArgs(arguments,1);return r.isTrue(r["symbol?"](n))?function(){var n=r.list(r.nil);return function(e,t,i){return r["list*"](r.list(r.intern("lambda"),r.list(e),r.list(r.intern("set!"),e,r["list*"](r.intern("lambda"),r.map(r.car,t),i)),r["list*"](e,r.map(r.cadr,t))),n)}}()(n,r.car(e),r.cdr(e)):r["list*"](r["list*"](r.intern("lambda"),r.map(r.car,n),e),r.map(r.cadr,n))}),r["register-macro"](r.intern("let1"),function(n,e){var t=r._getRestArgs(arguments,2);return r["list*"](r.intern("let"),r.list(r.list(n,e)),t)}),r["register-macro"](r.intern("let*"),function(n){var e=r._getRestArgs(arguments,1);return r.isTrue(r["null?"](n))?r["list*"](r.intern("progn"),e):r.list(r.intern("let1"),r.caar(n),r.cadar(n),r["list*"](r.intern("let*"),r.cdr(n),e))}),r["register-macro"](r.intern("when"),function(n){var e=r._getRestArgs(arguments,1);return r.list(r.intern("if"),n,r["list*"](r.intern("progn"),e))}),r["register-macro"](r.intern("unless"),function(n){var e=r._getRestArgs(arguments,1);return r.list(r.intern("if"),n,r.nil,r["list*"](r.intern("progn"),e))}),r["register-macro"](r.intern("cond"),function(){var n=r._getRestArgs(arguments,0);return r.isTrue(r["null?"](n))?r.nil:function(n,e){return r.isTrue(r["eq?"](r.car(n),r.t))?r["list*"](r.intern("progn"),r.cdr(n)):r.isTrue(r["null?"](r.cdr(n)))?function(t){return r.list(r.intern("let"),r.list(r.list(t,r.car(n))),r.list(r.intern("if"),t,t,r["list*"](r.intern("cond"),e)))}(r.gensym()):r.isTrue(r["eq?"](r.cadr(n),r.intern("=>")))?function(t){return r.list(r.intern("let"),r.list(r.list(t,r.car(n))),r.list(r.intern("if"),t,r.list(r.caddr(n),t),r["list*"](r.intern("cond"),e)))}(r.gensym()):r.list(r.intern("if"),r.car(n),r["list*"](r.intern("progn"),r.cdr(n)),r["list*"](r.intern("cond"),e))}(r.car(n),r.cdr(n))}),r["register-macro"](r.intern("case"),function(n){var e=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern("let1"),t,n,r["list*"](r.intern("cond"),r.map(function(n){return r.isTrue(r["eq?"](r.car(n),r.t))?n:r.isTrue(r["null?"](r.cdar(n)))?r["list*"](r.list(r.intern("eq?"),t,r.list(r.intern("quote"),r.caar(n))),r.cdr(n)):r["list*"](r.list(r.intern("member"),t,r.list(r.intern("quote"),r.car(n))),r.cdr(n))},e)))}(r.gensym())}),r["register-macro"](r.intern("and"),function(){var n=r.list(r.nil);return function(){var e=r._getRestArgs(arguments,0);return r.isTrue(r["null?"](e))?r.t:r.isTrue(r["null?"](r.cdr(e)))?r.car(e):r["list*"](r.intern("if"),r.car(e),r["list*"](r.intern("and"),r.cdr(e)),n)}}()),r["register-macro"](r.intern("or"),function(){var n=r._getRestArgs(arguments,0);return r.isTrue(r["null?"](r.cdr(n)))?r.car(n):function(e){return r.list(r.intern("let1"),e,r.car(n),r.list(r.intern("if"),e,e,r["list*"](r.intern("or"),r.cdr(n))))}(r.gensym())}),r["register-macro"](r.intern("progn"),function(){var n=r._getRestArgs(arguments,0);return r.isTrue(r["null?"](n))?r.nil:r.isTrue(r["null?"](r.cdr(n)))?r.car(n):r["list*"](r.intern("let"),r.nil,n)}),r["register-macro"](r.intern("aif"),function(n,e){var t=r._getRestArgs(arguments,2);return r.list(r.intern("let1"),r.intern("it"),n,r["list*"](r.intern("if"),r.intern("it"),e,t))}),r["register-macro"](r.intern("awhen"),function(n){var e=r._getRestArgs(arguments,1);return r.list(r.intern("aif"),n,r["list*"](r.intern("progn"),e))}),r["register-macro"](r.intern("awhile"),function(n){var e=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern("let"),t,r.nil,r.list(r.intern("let1"),r.intern("it"),n,r["list*"](r.intern("when"),r.intern("it"),r.append(e,r.list(r.list(t))))))}(r.gensym())}),r["null?"]=function(n){return r["eq?"](n,r.nil)},r.not=function(n){return r["eq?"](n,r.nil)},r.caar=function(n){return r.car(r.car(n))},r.cadr=function(n){return r.car(r.cdr(n))},r.cdar=function(n){return r.cdr(r.car(n))},r.cddr=function(n){return r.cdr(r.cdr(n))},r.cadar=function(n){return r.cadr(r.car(n))},r.caddr=function(n){return r.car(r.cddr(n))},r.cdddr=function(n){return r.cdr(r.cddr(n))},r["equal?"]=function(n,e){return r.isTrue(r["eq?"](n,e))?r.t:function(t){return r.isTrue(r["eq?"](t,r.type(e)))?function(t){return r.isTrue(r["eq?"](t,r.intern("pair")))?r.isTrue(r["equal?"](r.car(n),r.car(e)))?r["equal?"](r.cdr(n),r.cdr(e)):r.nil:r.isTrue(r["eq?"](t,r.intern("vector")))?function(t){return r.isTrue(r["eq?"](t,r["vector-length"](e)))?function(i){return(i=function(u){return function(t){return r.isTrue(t)?t:r.isTrue(r["equal?"](r["vector-ref"](n,u),r["vector-ref"](e,u)))?i(u+1):r.nil}(r[">="](u,t))})(0)}(r.nil):r.nil}(r["vector-length"](n)):r.nil}(t):r.nil}(r.type(n))},r.length=function(n){return function(e){return(e=function(n,t){return r.isTrue(r["pair?"](n))?e(r.cdr(n),t+1):t})(n,0)}(r.nil)},r["last-pair"]=function(n){return r.isTrue(r["pair?"](r.cdr(n)))?r["last-pair"](r.cdr(n)):n},r.member=function(n,e){return r.isTrue(r["null?"](e))?r.nil:r.isTrue(r["eq?"](n,r.car(e)))?e:r.member(n,r.cdr(e))},r.assoc=function(n,e){return r.isTrue(r["null?"](e))?r.nil:r.isTrue(r["eq?"](n,r.caar(e)))?r.car(e):r.assoc(n,r.cdr(e))},r.acons=function(n,e,t){return r.cons(r.cons(n,e),t)},r.map=function(n,e){return r.isTrue(r["null?"](e))?r.nil:r.cons(n(r.car(e)),r.map(n,r.cdr(e)))},r.append=function(n){var e=r._getRestArgs(arguments,1);return r.isTrue(r["null?"](e))?n:r.isTrue(r["null?"](n))?r.apply(r.append,e):r.cons(r.car(n),r.apply(r.append,r.cdr(n),e))},r.reverse=function(n){return function(e){return(e=function(n,t){return r.isTrue(r["pair?"](n))?e(r.cdr(n),r.cons(r.car(n),t)):t})(n,r.nil)}(r.nil)},r["list*"]=function(){var n=r._getRestArgs(arguments,0);return r.isTrue(r["null?"](n))?r.nil:r.isTrue(r["null?"](r.cdr(n)))?r.car(n):function(e){return(e=function(t,i){return r.isTrue(r["null?"](r.cdr(i)))?function(){return r["set-cdr!"](t,r.car(i)),n}():e(i,r.cdr(i))})(n,r.cdr(n))}(r.nil)},r["last-pair"]=function(n){return r.isTrue(r["pair?"](r.cdr(n)))?r["last-pair"](r.cdr(n)):n},r["proper-list?"]=function(n){return r.isTrue(r["pair?"](n))?r["null?"](r.cdr(r["last-pair"](n))):r.nil},r["dotted->proper"]=function(n){return r.isTrue(r["pair?"](n))?r.isTrue(r["proper-list?"](n))?n:function(n,e){return function(t){return r["set-cdr!"](e,r.list(n)),t}(r["reverse!"](e))}(r.cdr(r["last-pair"](n)),r.reverse(n)):r.list(n)},r["vector->list"]=function(n){return function(e){return(e=function(t,i){return r.isTrue(r["<"](t,0))?i:e(t-1,r.cons(r["vector-ref"](n,t),i))})(r["vector-length"](n)-1,r.nil)}(r.nil)},r["position-if"]=function(n,e){return function(t){return(t=function(e,i){return r.isTrue(e)?r.isTrue(n(r.car(e)))?i:t(r.cdr(e),i+1):r.nil})(e,0)}(r.nil)},r.take=function(n,e){return function(t){return(t=function(n,e,i){return r.isTrue(function(n){return r.isTrue(n)?n:r["null?"](e)}(r["<="](n,0)))?r["reverse!"](i):t(n-1,r.cdr(e),r.cons(r.car(e),i))})(n,e,r.nil)}(r.nil)},r.drop=function(n,e){return r.isTrue(function(n){return r.isTrue(n)?n:r["null?"](e)}(r["<="](n,0)))?e:r.drop(n-1,r.cdr(e))},r.elt=function(n,e){return r.car(r.drop(n,e))},r["remove-if"]=function(n,e){return function(t){return(t=function(e,i){return r.isTrue(r["null?"](e))?r["reverse!"](i):t(r.cdr(e),r.isTrue(n(r.car(e)))?i:r.cons(r.car(e),i))})(e,r.nil)}(r.nil)},r["register-macro"](r.intern("dotimes"),function(n){var e=r._getRestArgs(arguments,1);return function(){var t=r.list(0),i=r.list(1);return function(u,c,o){return r.list(r.intern("let1"),c,r.cadr(n),r.list(r.intern("let"),o,r.list(r["list*"](u,t)),r.list(r.intern("if"),r.list(r.intern("<"),u,c),r["list*"](r.intern("progn"),r.append(e,r.list(r.list(o,r["list*"](r.intern("+"),u,i))))),r.caddr(n))))}}()(r.car(n),r.gensym(),r.gensym())}),r["register-macro"](r.intern("dolist"),function(n){var e=r._getRestArgs(arguments,1);return function(t,i,u){return r.list(r.intern("let"),i,r.list(r.list(u,r.cadr(n))),r.list(r.intern("let1"),t,r.list(r.intern("car"),u),r["list*"](r.intern("when"),t,r.append(e,r.list(r.list(i,r.list(r.intern("cdr"),u)))))))}(r.car(n),r.gensym(),r.gensym())}),r["register-macro"](r.intern("labels"),function(n){var e=r._getRestArgs(arguments,1);return r["list*"](r.intern("let"),r.map(function(n){return r.car(n)},n),r.append(r.map(function(n){return r.list(r.intern("set!"),r.car(n),r["list*"](r.intern("lambda"),r.cdr(n)))},n),e))}),r["register-macro"](r.intern("deftype?"),function(){var n=r._getRestArgs(arguments,0);return r["list*"](r.intern("progn"),r.map(function(){var n=r.list(r.intern("x")),e=r.list(r.intern("type"),r.intern("x"));return function(t){return r.list(r.intern("defun"),r.intern(r["string-append"](t,"?")),n,r.list(r.intern("eq?"),e,r.list(r.intern("quote"),t)))}}(),n))}),function(){return r["symbol?"]=function(n){return r["eq?"](r.type(n),r.intern("symbol"))},r["pair?"]=function(n){return r["eq?"](r.type(n),r.intern("pair"))},r["number?"]=function(n){return r["eq?"](r.type(n),r.intern("number"))},r["string?"]=function(n){return r["eq?"](r.type(n),r.intern("string"))},r["keyword?"]=function(n){return r["eq?"](r.type(n),r.intern("keyword"))},r["vector?"]=function(n){return r["eq?"](r.type(n),r.intern("vector"))},r["table?"]=function(n){return r["eq?"](r.type(n),r.intern("table"))},r["regexp?"]=function(n){return r["eq?"](r.type(n),r.intern("regexp"))}}(),r.nreconc=function(n,e){return function(t){return r["set-cdr!"](n,e),t}(r["reverse!"](n))},r.any=function(n,e){return r.isTrue(r["null?"](e))?r.nil:r.isTrue(n(r.car(e)))?r.t:r.any(n,r.cdr(e))},r.every=function(n,e){return r.isTrue(r["null?"](e))?r.t:r.isTrue(n(r.car(e)))?r.every(n,r.cdr(e)):r.nil},r["*bq-clobberable*"]=r.gensym(),r["*bq-quote-nil*"]=r.list(r.intern("quote"),r.nil),r["register-macro"](r.intern("quasiquote"),function(n){return r["bq-completely-process"](n)}),r["bq-completely-process"]=function(n){return r["bq-simplify"](r["bq-process"](n))},r["bq-process"]=function(n){return r.isTrue(r.not(r["pair?"](n)))?r.list(r.intern("quote"),n):r.isTrue(r["eq?"](r.car(n),r.intern("quasiquote")))?r["bq-process"](r["bq-completely-process"](r.cadr(n))):r.isTrue(r["eq?"](r.car(n),r.intern("unquote")))?r.cadr(n):r.isTrue(r["eq?"](r.car(n),r.intern("unquote-splicing")))?r.error(",@~S after `",r.cadr(n)):r.isTrue(r["eq?"](r.car(n),r.intern("unquote-dot")))?r.error(",.~S after `",r.cadr(n)):function(e){return(e=function(n,t){return r.isTrue(r.not(r["pair?"](n)))?r.cons(r.intern("append"),r.nreconc(t,r.list(r.list(r.intern("quote"),n)))):r.isTrue(r["eq?"](r.car(n),r.intern("unquote")))?function(){return r.isTrue(r["null?"](r.cddr(n)))?r.nil:r.error("Malformed ,~S",n),r.cons(r.intern("append"),r.nreconc(t,r.list(r.cadr(n))))}():function(){return r.isTrue(r["eq?"](r.car(n),r.intern("unquote-splicing")))?r.error("Dotted ,@~S",n):r.nil,r.isTrue(r["eq?"](r.car(n),r.intern("unquote-dot")))?r.error("Dotted ,.~S",n):r.nil,e(r.cdr(n),r.cons(r.bracket(r.car(n)),t))}()})(n,r.nil)}(r.nil)},r.bracket=function(n){return r.isTrue(r.not(r["pair?"](n)))?r.list(r.intern("list"),r["bq-process"](n)):r.isTrue(r["eq?"](r.car(n),r.intern("unquote")))?r.list(r.intern("list"),r.cadr(n)):r.isTrue(r["eq?"](r.car(n),r.intern("unquote-splicing")))?r.cadr(n):r.isTrue(r["eq?"](r.car(n),r.intern("unquote-dot")))?r.list(r["*bq-clobberable*"],r.cadr(n)):r.list(r.intern("list"),r["bq-process"](n))},r.maptree=function(n,e){return r.isTrue(r.not(r["pair?"](e)))?n(e):function(n,t){return r.isTrue(r.isTrue(r["equal?"](n,r.car(e)))?r["equal?"](t,r.cdr(e)):r.nil)?e:r.cons(n,t)}(n(r.car(e)),r.maptree(n,r.cdr(e)))},r["bq-splicing-frob"]=function(n){return r.isTrue(r["pair?"](n))?function(e){return r.isTrue(e)?e:r["eq?"](r.car(n),r.intern("unquote-dot"))}(r["eq?"](r.car(n),r.intern("unquote-splicing"))):r.nil},r["bq-frob"]=function(n){return r.isTrue(r["pair?"](n))?function(e){return r.isTrue(e)?e:function(e){return r.isTrue(e)?e:r["eq?"](r.car(n),r.intern("unquote-dot"))}(r["eq?"](r.car(n),r.intern("unquote-splicing")))}(r["eq?"](r.car(n),r.intern("unquote"))):r.nil},r["bq-simplify"]=function(n){return r.isTrue(r["pair?"](n))?function(n){return r.isTrue(r.not(r["eq?"](r.car(n),r.intern("append"))))?n:r["bq-simplify-args"](n)}(r.isTrue(r["eq?"](r.car(n),r.intern("quote")))?n:r.maptree(r["bq-simplify"],n)):n},r["bq-simplify-args"]=function(n){return function(e){return(e=function(n,t){return r.isTrue(r.not(r["null?"](n)))?e(r.cdr(n),r.isTrue(r.not(r["pair?"](r.car(n))))?r["bq-attach-append"](r.intern("append"),r.car(n),t):r.isTrue(r.isTrue(r["eq?"](r.caar(n),r.intern("list")))?r.not(r.any(r["bq-splicing-frob"],r.cdar(n))):r.nil)?r["bq-attach-conses"](r.cdar(n),t):r.isTrue(r.isTrue(r["eq?"](r.caar(n),r.intern("list*")))?r.not(r.any(r["bq-splicing-frob"],r.cdar(n))):r.nil)?r["bq-attach-conses"](r.reverse(r.cdr(r.reverse(r.cdar(n)))),r["bq-attach-append"](r.intern("append"),r.car(r.last(r.car(n))),t)):r.isTrue(r.isTrue(r["eq?"](r.caar(n),r.intern("quote")))&&r.isTrue(r["pair?"](r.cadar(n)))&&r.isTrue(r.not(r["bq-frob"](r.cadar(n))))?r.not(r.cddar(n)):r.nil)?r["bq-attach-conses"](r.list(r.list(r.intern("quote"),r.caadar(n))),t):r.isTrue(r["eq?"](r.caar(n),r["*bq-clobberable*"]))?r["bq-attach-append"](r.intern("append!"),r.cadar(n),t):r["bq-attach-append"](r.intern("append"),r.car(n),t)):t})(r.reverse(r.cdr(n)),r.nil)}(r.nil)},r["null-or-quoted"]=function(n){return function(e){return r.isTrue(e)?e:r.isTrue(r["pair?"](n))?r["eq?"](r.car(n),r.intern("quote")):r.nil}(r["null?"](n))},r["bq-attach-append"]=function(n,e,t){return r.isTrue(r.isTrue(r["null-or-quoted"](e))?r["null-or-quoted"](t):r.nil)?r.list(r.intern("quote"),r.append(r.cadr(e),r.cadr(t))):r.isTrue(function(n){return r.isTrue(n)?n:r["equal?"](t,r["*bq-quote-nil*"])}(r["null?"](t)))?r.isTrue(r["bq-splicing-frob"](e))?r.list(n,e):e:r.isTrue(r.isTrue(r["pair?"](t))?r["eq?"](r.car(t),n):r.nil)?r["list*"](r.car(t),e,r.cdr(t)):r.list(n,e,t)},r["bq-attach-conses"]=function(n,e){return r.isTrue(r.isTrue(r.every(r["null-or-quoted"],n))?r["null-or-quoted"](e):r.nil)?r.list(r.intern("quote"),r.append(r.map(r.cadr,n),r.cadr(e))):r.isTrue(function(n){return r.isTrue(n)?n:r["equal?"](e,r["*bq-quote-nil*"])}(r["null?"](e)))?r.cons(r.intern("list"),n):r.isTrue(r.isTrue(r["pair?"](e))?function(n){return r.isTrue(n)?n:r["eq?"](r.car(e),r.intern("list*"))}(r["eq?"](r.car(e),r.intern("list"))):r.nil)?r.cons(r.car(e),r.append(n,r.cdr(e))):r.cons(r.intern("list*"),r.append(n,r.list(e)))},r["create-scope"]=function(n,e){return r.vector(r["remove-if"](function(){var n=r.list(r.intern("&rest"),r.intern("&body"));return function(e){return r.member(e,n)}}(),e),r.nil,n)},r["scope-param"]=function(n){return r["vector-ref"](n,0)},r["scope-outer"]=function(n){return r["vector-ref"](n,2)},r["scope-add-var"]=function(n,e){return function(t){return r["vector-set!"](n,1,r.cons(r.cons(t,e),r["vector-ref"](n,1))),r["vector-set!"](n,0,r.cons(t,r["vector-ref"](n,0))),t}(r.gensym())},r["scope-get-var"]=function(n){return r["vector-ref"](n,1)},r["scope-var?"]=function(n,e){return r.isTrue(r["null?"](n))?r.nil:r.isTrue(r.member(e,r["scope-param"](n)))?r.t:r["scope-var?"](r["scope-outer"](n),e)},r["local-var?"]=function(n,e){return r.isTrue(r["symbol?"](e))?r["scope-var?"](n,r["get-receiver"](e)):r.nil},r["special-var?"]=function(){var n=r.list(r.intern("this"));return function(e,t){return r.member(t,n)}}(),r["get-receiver"]=function(n){return function(e){return function(t){return r.isTrue(t)?r.intern(r.substring(e,0,t)):n}(r["string-scan"](e,"."))}(r["symbol->string"](n))},r["register-macro"](r.intern("record"),function(n,e){var t=r._getRestArgs(arguments,2);return r.list(r.intern("apply"),r["list*"](r.intern("lambda"),e,t),n)}),r["register-macro"](r.intern("record-case"),function(n){var e=r._getRestArgs(arguments,1);return function(t){return r.list(r.intern("let1"),t,n,r["list*"](r.intern("case"),r.list(r.intern("car"),t),r.map(function(n){return r.isTrue(r["eq?"](r.car(n),r.t))?n:function(e){return r.list(r.list(e),r["list*"](r.intern("record"),r.list(r.intern("cdr"),t),r.cdar(n),r.cdr(n)))}(r.caar(n))},e)))}(r.gensym())}),function(n,e,t){return n=function(n,e){return r.map(function(n){return r["traverse*"](n,e)},n)},e=function(n){return r.isTrue(n)?r.isTrue(r["symbol?"](r.car(n)))?e(r.cdr(n)):r["compile-error"]("function parameter must be symbol, but",r.car(n)):r.nil},t=function(n){return r.isTrue(r["pair?"](n))?r.vector(r["make-keyword"]("FUNCALL"),r.vector(r["make-keyword"]("REF"),r.isTrue(r["proper-list?"](n))?r.intern("list"):r.intern("list*")),r.map(t,r["dotted->proper"](n))):r.vector(r["make-keyword"]("CONST"),n)},r["traverse-list"]=function(i,u){return function(c){return function(o){return r.isTrue(r["eq?"](o,r.intern("quote")))?r.apply(function(n){return r.isTrue(r["pair?"](n))?r.vector(r["make-keyword"]("REF"),r["scope-add-var"](u,t(n))):r.vector(r["make-keyword"]("CONST"),n)},r.cdr(c)):r.isTrue(r["eq?"](o,r.intern("if")))?r.apply(function(n,e){var t=r._getRestArgs(arguments,2);return r.vector(r["make-keyword"]("IF"),r["traverse*"](n,u),r["traverse*"](e,u),r.isTrue(r["null?"](t))?r.nil:r["traverse*"](r.car(t),u))},r.cdr(c)):r.isTrue(r["eq?"](o,r.intern("set!")))?r.apply(function(n,e){return r.vector(r["make-keyword"]("SET!"),r["traverse*"](n,u),r["traverse*"](e,u));
},r.cdr(c)):r.isTrue(r["eq?"](o,r.intern("lambda")))?r.apply(function(t){var i=r._getRestArgs(arguments,1);return function(){return e(t),function(e){return r.vector(r["make-keyword"]("LAMBDA"),e,t,n(i,e))}(r["create-scope"](u,t))}()},r.cdr(c)):r.isTrue(r["eq?"](o,r.intern("def")))?r.apply(function(n,e){return r.vector(r["make-keyword"]("DEF"),r["traverse*"](n,u),r["traverse*"](e,u))},r.cdr(c)):r.isTrue(r["eq?"](o,r.intern("new")))?r.apply(function(e){var t=r._getRestArgs(arguments,1);return r.vector(r["make-keyword"]("NEW"),e,n(t,r["new-scope"]))},r.cdr(c)):r.vector(r["make-keyword"]("FUNCALL"),r["traverse*"](r.car(i),u),n(r.cdr(i),u))}(r.car(c))}(i)}}(r.nil,r.nil,r.nil),r["traverse*"]=function(n,e){return r.isTrue(r["pair?"](n))?r.isTrue(r["local-var?"](e,r.car(n)))?r["traverse-list"](n,e):function(n){return r.isTrue(r["pair?"](n))?r["traverse-list"](n,e):r["traverse*"](n,e)}(r.macroexpand(n)):r.isTrue(r["symbol?"](n))?r.vector(r["make-keyword"]("REF"),n):r.vector(r["make-keyword"]("CONST"),n)},r["expand-args"]=function(n,e){return r["string-join"](r.map(function(n){return r["compile*"](n,e)},n),", ")},r["expand-body"]=function(n,e){return r.isTrue(r["null?"](n))?"LISP.nil":r["expand-args"](n,e)},function(n){return r["hash-table-put!"](n,"\\","\\\\"),r["hash-table-put!"](n,"	","\\t"),r["hash-table-put!"](n,"\n","\\n"),r["hash-table-put!"](n,'"','\\"'),r["escape-char"]=function(e){return function(n){return r.isTrue(n)?n:e}(r["hash-table-get"](n,e))}}(r["make-hash-table"]()),r["escape-string"]=function(n){return r["regexp-replace-all"](/[\\\t\n"]/,n,function(n){return r["escape-char"](n())})},r["escape-sym-char"]=function(n){return r["string-append"]("$",r["integer->hex-string"](r["char->integer"](n),"00"))},r["integer->hex-string"]=function(n,e){return function(n){return function(t){return function(e){return r.substring(n,t-e,t)}(r["string-length"](e))}(r["string-length"](n))}(r["string-append"](e,r["number->string"](n,16)))},r["escape-symbol"]=function(n){return r["regexp-replace-all"](/[^0-9A-Za-z_.]/,r["symbol->string"](n),function(n){return r["escape-sym-char"](r["string-ref"](n(),0))})},r["compile-symbol"]=function(n,e){return r.isTrue(function(t){return r.isTrue(t)?t:r["special-var?"](e,n)}(r["local-var?"](e,n)))?r["escape-symbol"](n):function(n){return r.isTrue(r.rxmatch(/^[0-9A-Za-z_.]*$/,n))?r["string-append"]("LISP.",n):r["string-append"]('LISP["',r["escape-string"](n),'"]')}(r["symbol->string"](n))},r["compile-keyword"]=function(n){return r["string-append"]('LISP["make-keyword"]("',r["escape-string"](r["keyword->string"](n)),'")')},r["compile-vector"]=function(n,e){return r["string-append"]("[",r["string-join"](r.map(function(n){return r["compile-quote"](n,e)},r["vector->list"](n)),", "),"]")},r["compile-regexp"]=function(n){return r["string-append"]("/",r["regexp->string"](n),"/")},r["compile-literal"]=function(n,e){return r.isTrue(r["number?"](n))?r["number->string"](n):r.isTrue(r["symbol?"](n))?r["compile-symbol"](n,e):r.isTrue(r["keyword?"](n))?r["compile-keyword"](n):r.isTrue(r["string?"](n))?r["x->string"](n,r.t):r.isTrue(r["vector?"](n))?r["compile-vector"](n,e):r.isTrue(r["regexp?"](n))?r["compile-regexp"](n):r.isTrue(r["null?"](n))?"LISP.nil":r.isTrue(r["eq?"](n,r.t))?"LISP.t":r.error(r["string-append"]("compile-literal: [",n,"]"))},r["unary-op?"]=function(){var n=r.list(r.intern("+"),r.intern("-"),r.intern("!"),r.intern("~"));return function(e){return r.member(e,n)}}(),r["compile-unary-op"]=function(n,e,t){return r["string-append"]("(",r["symbol->string"](n),r["compile*"](e,t),")")},r["binop?"]=function(){var n=r.list(r.intern("+"),r.intern("-"),r.intern("*"),r.intern("/"),r.intern("%"));return function(e){return r.member(e,n)}}(),r["compile-binop"]=function(n,e,t){return r["string-append"]("(",r["string-join"](r.map(function(n){return r["compile*"](n,t)},e),r["string-append"](" ",r["symbol->string"](n)," ")),")")},r["do-compile-funcall"]=function(n,e,t){return r["string-append"](r["compile*"](n,t),"(",r["expand-args"](e,t),")")},r["compile-funcall"]=function(n,e,t){return r.isTrue(r.isTrue(r["eq?"](r["vector-ref"](n,0),r["make-keyword"]("REF")))&&r.isTrue(r.not(r["local-var?"](t,r["vector-ref"](n,1))))?r.not(r["null?"](e)):r.nil)?function(i){return r.isTrue(r.isTrue(r["binop?"](i))?r.not(r["null?"](r.cdr(e))):r.nil)?r["compile-binop"](i,e,t):r.isTrue(r.isTrue(r["unary-op?"](i))?r["null?"](r.cdr(e)):r.nil)?r["compile-unary-op"](i,r.car(e),t):r["do-compile-funcall"](n,e,t)}(r["vector-ref"](n,1)):r["do-compile-funcall"](n,e,t)},r["compile-quote"]=function(n,e){return r.isTrue(r["pair?"](n))?r["compile*"](r.list(r.intern("cons"),r.list(r.intern("quote"),r.car(n)),r.list(r.intern("quote"),r.cdr(n))),e):r.isTrue(r["symbol?"](n))?r["string-append"]('LISP.intern("',r["escape-string"](r["symbol->string"](n)),'")'):r.isTrue(r["keyword?"](n))?r["compile-keyword"](n):r["compile-literal"](n,e)},r["compile-if"]=function(n,e,t,i){return r["string-append"]("(LISP.isTrue(",r["compile*"](n,i),") ? (",r["compile*"](e,i),") : (",r.isTrue(t)?r["compile*"](t,i):"LISP.nil","))")},r["compile-set!"]=function(n,e,t){return r["string-append"](r["compile*"](n,t)," = ",r["compile*"](e,t))},r["compile-lambda"]=function(n,e,t,i){return r.isTrue(function(e){return r.isTrue(e)?e:r["pair?"](n)}(r["null?"](n)))?r.nil:r.error("function parameters must be a list"),function(t){return function(n,t){return r["string-append"]("(function(",r["string-join"](r.map(function(n){return r["escape-symbol"](n)},n),", "),"){",r.isTrue(r["null?"](t))?"":r["string-append"]("var ",r["escape-symbol"](t)," = LISP._getRestArgs(arguments, ",r["number->string"](r.length(n)),"); "),"return (",r["expand-body"](e,i),");})")}(r.isTrue(t)?r.take(t,n):n,r.isTrue(t)?r.elt(t+1,n):r.nil)}(r["position-if"](function(){var n=r.list(r.intern("&rest"),r.intern("&body"));return function(e){return r.member(e,n)}}(),n))},r["compile-def"]=function(n,e,t){return r["string-append"](r["compile*"](n,t)," = ",r["compile*"](e,t))},r["compile-new"]=function(n,e,t){return r["string-append"]("new ",r["symbol->string"](n),"(",r["expand-args"](e,t),")")},r["compile-new-scope"]=function(n,e){return function(t){return r.isTrue(t)?r["string-append"]("(function() { var ",r["string-join"](r.map(function(n){return r["string-append"](r["escape-symbol"](r.car(n))," = ",r["compile*"](r.cdr(n),e))},r.reverse(t)),", "),"; return ",n,"; })()"):n}(r["scope-get-var"](e))},r["compile*"]=function(n,e){return function(t){return r.isTrue(r["eq?"](t,r["make-keyword"]("CONST")))?r["compile-quote"](r["vector-ref"](n,1),e):r.isTrue(r["eq?"](t,r["make-keyword"]("REF")))?r["compile-symbol"](r["vector-ref"](n,1),e):r.isTrue(r["eq?"](t,r["make-keyword"]("IF")))?function(n,t,i){return r["compile-if"](n,t,i,e)}(r["vector-ref"](n,1),r["vector-ref"](n,2),r["vector-ref"](n,3)):r.isTrue(r["eq?"](t,r["make-keyword"]("FUNCALL")))?r["compile-funcall"](r["vector-ref"](n,1),r["vector-ref"](n,2),e):r.isTrue(r["eq?"](t,r["make-keyword"]("SET!")))?r["compile-set!"](r["vector-ref"](n,1),r["vector-ref"](n,2),e):r.isTrue(r["eq?"](t,r["make-keyword"]("LAMBDA")))?function(n,t,i){return r["compile-new-scope"](r["compile-lambda"](t,i,e,n),n)}(r["vector-ref"](n,1),r["vector-ref"](n,2),r["vector-ref"](n,3)):r.isTrue(r["eq?"](t,r["make-keyword"]("DEF")))?r["compile-def"](r["vector-ref"](n,1),r["vector-ref"](n,2),e):r.isTrue(r["eq?"](t,r["make-keyword"]("NEW")))?r["compile-new"](r["vector-ref"](n,1),r["vector-ref"](n,2),e):r["compile-error"]("Unknown AST node:",n)}(r["vector-ref"](n,0))},r["compile-error"]=function(){var n=r._getRestArgs(arguments,0);return r.error(n)},r.compile=function(n){return function(e){return function(n){return r["compile-new-scope"](r["compile*"](n,e),e)}(r["traverse*"](n,e))}(r["create-scope"](r.nil,r.nil))}});
//# sourceMappingURL=lisp2js.min.js.map
